





<div class="sheet-character">

    <div class="sheet-row-flex">
        <div class="sheet-main">
            <div class="sheet-row-flex">
                

    <div class="sheet-bubble ">
        <div class="sheet-title">
            
                Health
            
        </div>

        <div class="sheet-content">
            
                    
    <div class="sheet-max">
        <div>
            <input type="text" class="sheet-number sheet-shy" name="attr_hp" value="30"/>
        </div>
        <div class="sheet-divider">/</div>
        <div>
            <input type="text" class="sheet-number sheet-shy" name="attr_hp_max" value="30"/>
        </div>
    </div>

                
        </div>
    </div>

                

    <div class="sheet-bubble ">
        <div class="sheet-title">
            
                AP
            
        </div>

        <div class="sheet-content">
            
                    
    <div class="sheet-max">
        <div>
            <input type="text" class="sheet-number sheet-shy" name="attr_ap" value="15"/>
        </div>
        <div class="sheet-divider">/</div>
        <div>
            <input type="text" class="sheet-number sheet-shy" name="attr_ap_max" value="15"/>
        </div>
    </div>

                
        </div>
    </div>

                

    <div class="sheet-bubble flex-60">
        <div class="sheet-title">
            
                Notes
            
        </div>

        <div class="sheet-content">
            
                    
    <textarea class="sheet-small sheet-vertical" name="attr_notes"></textarea>


                
        </div>
    </div>

            </div>
            

    <div class="sheet-bubble extra-bottom">
        <div class="sheet-title">
            
                Ability
            
        </div>

        <div class="sheet-content">
            
                    
    <div class="sheet-row-flex select-switch">
        <div class="select-switch-dropdown">

            <select name="attr_ability">
                
                     <option value="selectability"> Select an Ability </option>
                
                     <option value="brawler"> Brawler </option>
                
                     <option value="builder"> Builder </option>
                
                     <option value="cheerleader"> Cheerleader </option>
                
                    
                
                     <option value="Speedster"> Speedster </option>
                
                     <option value="prepared"> Doomsday Prep </option>
                
                     <option value="scavenger"> Scavenger </option>
                
                     <option value="sniper"> Sniper </option>
                
            </select>
        </div>

        
             
                <input type="checkbox" class="sheet-hidden ability-control select-switch-control select-switch-control-1" name="attr_ability" value="selectability" checked />

                <div class="select-switch-display select-switch-display-1 ability-abc">
                    <div class="ability-text select-switch-content-1">
                        
                    </div>
                </div>
            
        
             
                <input type="checkbox" class="sheet-hidden ability-control select-switch-control select-switch-control-2" name="attr_ability" value="brawler"  />

                <div class="select-switch-display select-switch-display-2 ability-brawler">
                    <div class="ability-text select-switch-content-2">
                        Any excess guard is dealt as damage.
                    </div>
                </div>
            
        
             
                <input type="checkbox" class="sheet-hidden ability-control select-switch-control select-switch-control-3" name="attr_ability" value="builder"  />

                <div class="select-switch-display select-switch-display-3 ability-builder">
                    <div class="ability-text select-switch-content-3">
                        Create a distraction device by spending 1 AP and 1 Item. The device will attract common zombies towards it for some time.
                    </div>
                </div>
            
        
             
                <input type="checkbox" class="sheet-hidden ability-control select-switch-control select-switch-control-4" name="attr_ability" value="cheerleader"  />

                <div class="select-switch-display select-switch-display-4 ability-cheerleader">
                    <div class="ability-text select-switch-content-4">
                        Reduce difficulty of roll for adjacent allies by 1 level.
                    </div>
                </div>
            
        
            
        
             
                <input type="checkbox" class="sheet-hidden ability-control select-switch-control select-switch-control-6" name="attr_ability" value="Speedster"  />

                <div class="select-switch-display select-switch-display-6 ability-parkour">
                    <div class="ability-text select-switch-content-6">
                        You can move 3 spaces at no cost on your turn.
                    </div>
                </div>
            
        
             
                <input type="checkbox" class="sheet-hidden ability-control select-switch-control select-switch-control-7" name="attr_ability" value="prepared"  />

                <div class="select-switch-display select-switch-display-7 ability-prepared">
                    <div class="ability-text select-switch-content-7">
                        Start the game with 5 free scavenge actions and 2 additional equipment slots.
                    </div>
                </div>
            
        
             
                <input type="checkbox" class="sheet-hidden ability-control select-switch-control select-switch-control-8" name="attr_ability" value="scavenger"  />

                <div class="select-switch-display select-switch-display-8 ability-scavenger">
                    <div class="ability-text select-switch-content-8">
                        Draw 1 additional cards when you scavenge. If you are scavenging a location alone, draw 3.
                    </div>
                </div>
            
        
             
                <input type="checkbox" class="sheet-hidden ability-control select-switch-control select-switch-control-9" name="attr_ability" value="sniper"  />

                <div class="select-switch-display select-switch-display-9 ability-sniper">
                    <div class="ability-text select-switch-content-9">
                        If you don't attack this turn, you can make a free attack roll and add that to next turn's ranged attack.
                    </div>
                </div>
            
        
    </div>

                
        </div>
    </div>



        <div class="sheet-equipment-slots">
            

    <div class="sheet-slot-section sheet-slot-section-equipment">
        <div class="sheet-row-flex sheet-label-row">
            <label>Equipment</label>
            <div class="sheet-subtext">
                Slots:
                <input type="text" class="sheet-number sheet-shy" name="attr_equipmentslots" value="2"/>
            </div>
        
        </div>

        
        <div class="sheet-wrap sheet-slot-toggle">
            
             
                <input type="checkbox" class="sheet-hidden sheet-slot-toggle sheet-slot-toggle-1" name="attr_equipmentslots" value="1" checked/>
             
                <input type="checkbox" class="sheet-hidden sheet-slot-toggle sheet-slot-toggle-2" name="attr_equipmentslots" value="2" checked/>
             
                <input type="checkbox" class="sheet-hidden sheet-slot-toggle sheet-slot-toggle-3" name="attr_equipmentslots" value="3" />
             
                <input type="checkbox" class="sheet-hidden sheet-slot-toggle sheet-slot-toggle-4" name="attr_equipmentslots" value="4" />
             
                <input type="checkbox" class="sheet-hidden sheet-slot-toggle sheet-slot-toggle-5" name="attr_equipmentslots" value="5" />
             
                <input type="checkbox" class="sheet-hidden sheet-slot-toggle sheet-slot-toggle-6" name="attr_equipmentslots" value="6" />
            

            
             
                <div class="sheet-slot sheet-slot-1">
                    
                    <input type="checkbox" class="slot-control sheet-hidden" name="attr_equipment_1"/>
                    <div class="sheet-empty-text">Unused Slot</div>
                    <div class="slot-content">
                        

    <div class="sheet-card">
        
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-inventory" name="attr_equipment_type_1" value="inventory" />
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-weapon" name="attr_equipment_type_1" value="weapon" />
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-equipment" name="attr_equipment_type_1" value="equipment" checked/>
        

        
        <div class="sheet-card-type">
            <select class="sheet-shy" name="attr_equipment_type_1">
                
                    <option value="inventory" >Consumable </option>
                
                    <option value="weapon" >Weapon</option>
                
                    <option value="equipment"  selected="selected" >Equipment</option>
                
            </select>            
            <select class="sheet-shy sheet-weapon-only" name="attr_equipment_weapontype_1">
                
                    <option value="melee"  selected="selected" >Melee</option>
                
                    <option value="ranged" >Ranged</option>
                
            </select>
        </div>

        
        
            <input type="checkbox" class="sheet-hidden sheet-show-melee" name="attr_equipment_weapontype_1" value="melee" checked/>
        
            <input type="checkbox" class="sheet-hidden sheet-show-ranged" name="attr_equipment_weapontype_1" value="ranged" />
        

        
        <div class="sheet-card-name">
            <input type="text" name="attr_equipment_name_1" placeholder="Item Name">
        </div>

        
        <div class="sheet-card-weapon-fields">        
            
            
            <div class="sheet-card-damage  sheet-card-line">
                <div class="sheet-label">Damage:</div>
                <input class="sheet-shy" type="text" name="attr_equipment_damage_1" value="0" />
            </div>

            
            <div class="sheet-card-uses sheet-card-line">
                <div class="sheet-label sheet-ranged-only">Ammo:</div>
                <div class="sheet-label sheet-melee-only">Durability:</div>
                <div class="sheet-max">
                    <div>
                        <input type="text" class="sheet-number sheet-shy" name="attr_equipment_uses_1" value="0"/>
                    </div>
                    <div class="sheet-divider">/</div>
                    <div>
                        <input type="text" class="sheet-number sheet-shy" name="attr_equipment_uses_max_1" value="0"/>
                    </div>
                </div>
            </div>

            
            

        </div>

        <div class="sheet-card-textarea">
            <textarea class="sheet-shy" name="attr_equipment_description_1"></textarea>
            <input type="text" class="sheet-hidden" name="attr_equipment_flavor_1"/>
            <span readonly name="attr_equipment_flavor_1"></span>
        </div>
        <div class="sheet-card-actions">
            
            
            
            
            <button type="roll" class="sheet-attack-button sheet-attack-melee btn" value="!!combat success='?{Number of Attacks | @{ap_rolls}}' guard='?{Number of Defense Rolls | @{ap_rolls}}' sdice='@{equipment_damage_1}' gdice='d@{}' sbonus='@{melee_skill}' gbonus='@{}' weaponname='@{equipment_name_1}' type='@{equipment_weapontype_1}' sresource='equipment_uses_1'  limit='@{ap}' characterid='@{character_id}'" name="roll_attackweapon" >Combat</button>
            <button type="roll" class="sheet-attack-button sheet-attack-ranged btn" value="!!combat success='?{Number of Attacks | @{ap_rolls}}' guard='?{Number of Defense Rolls | @{ap_rolls}}' sdice='@{equipment_damage_1}' gdice='d@{}' sbonus='@{ranged_skill}' gbonus='@{}' weaponname='@{equipment_name_1}' type='@{equipment_weapontype_1}' sresource='equipment_uses_1'  limit='@{ap}' characterid='@{character_id}'" name="roll_attackweapon" >Combat</button>
            
            <button type="action" class="sheet-equip-button btn" name="act_equipment_equipitem_1">Equip</button>
            <button type="action" class="sheet-unequip-button btn" name="act_equipment_unequipitem_1">Unequip</button>
            <button type="roll" class="sheet-export-button" name="roll_exportitem" value="!!pickup  name=&#39;@{name}&#39;  type=&#39;@{type}&#39;  damage=&#39;@{damage}&#39;  weapontype=&#39;@{weapontype}&#39;  uses=&#39;@{uses}&#39;  description=&#39;@{description}&#39;  flavor=&#39;@{flavor}&#39;  characterid=@{target|Target 1|character_id}'" >Trade Item</button>
            <button type="action" class="sheet-delete-button btn-danger" name="act_equipment_deleteitem_1">Delete</button>
        </div>
    </div>

                    </div>
                </div>
             
                <div class="sheet-slot sheet-slot-2">
                    
                    <input type="checkbox" class="slot-control sheet-hidden" name="attr_equipment_2"/>
                    <div class="sheet-empty-text">Unused Slot</div>
                    <div class="slot-content">
                        

    <div class="sheet-card">
        
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-inventory" name="attr_equipment_type_2" value="inventory" />
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-weapon" name="attr_equipment_type_2" value="weapon" />
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-equipment" name="attr_equipment_type_2" value="equipment" checked/>
        

        
        <div class="sheet-card-type">
            <select class="sheet-shy" name="attr_equipment_type_2">
                
                    <option value="inventory" >Consumable </option>
                
                    <option value="weapon" >Weapon</option>
                
                    <option value="equipment"  selected="selected" >Equipment</option>
                
            </select>            
            <select class="sheet-shy sheet-weapon-only" name="attr_equipment_weapontype_2">
                
                    <option value="melee"  selected="selected" >Melee</option>
                
                    <option value="ranged" >Ranged</option>
                
            </select>
        </div>

        
        
            <input type="checkbox" class="sheet-hidden sheet-show-melee" name="attr_equipment_weapontype_2" value="melee" checked/>
        
            <input type="checkbox" class="sheet-hidden sheet-show-ranged" name="attr_equipment_weapontype_2" value="ranged" />
        

        
        <div class="sheet-card-name">
            <input type="text" name="attr_equipment_name_2" placeholder="Item Name">
        </div>

        
        <div class="sheet-card-weapon-fields">        
            
            
            <div class="sheet-card-damage  sheet-card-line">
                <div class="sheet-label">Damage:</div>
                <input class="sheet-shy" type="text" name="attr_equipment_damage_2" value="0" />
            </div>

            
            <div class="sheet-card-uses sheet-card-line">
                <div class="sheet-label sheet-ranged-only">Ammo:</div>
                <div class="sheet-label sheet-melee-only">Durability:</div>
                <div class="sheet-max">
                    <div>
                        <input type="text" class="sheet-number sheet-shy" name="attr_equipment_uses_2" value="0"/>
                    </div>
                    <div class="sheet-divider">/</div>
                    <div>
                        <input type="text" class="sheet-number sheet-shy" name="attr_equipment_uses_max_2" value="0"/>
                    </div>
                </div>
            </div>

            
            

        </div>

        <div class="sheet-card-textarea">
            <textarea class="sheet-shy" name="attr_equipment_description_2"></textarea>
            <input type="text" class="sheet-hidden" name="attr_equipment_flavor_2"/>
            <span readonly name="attr_equipment_flavor_2"></span>
        </div>
        <div class="sheet-card-actions">
            
            
            
            
            <button type="roll" class="sheet-attack-button sheet-attack-melee btn" value="!!combat success='?{Number of Attacks | @{ap_rolls}}' guard='?{Number of Defense Rolls | @{ap_rolls}}' sdice='@{equipment_damage_2}' gdice='d@{}' sbonus='@{melee_skill}' gbonus='@{}' weaponname='@{equipment_name_2}' type='@{equipment_weapontype_2}' sresource='equipment_uses_2'  limit='@{ap}' characterid='@{character_id}'" name="roll_attackweapon" >Combat</button>
            <button type="roll" class="sheet-attack-button sheet-attack-ranged btn" value="!!combat success='?{Number of Attacks | @{ap_rolls}}' guard='?{Number of Defense Rolls | @{ap_rolls}}' sdice='@{equipment_damage_2}' gdice='d@{}' sbonus='@{ranged_skill}' gbonus='@{}' weaponname='@{equipment_name_2}' type='@{equipment_weapontype_2}' sresource='equipment_uses_2'  limit='@{ap}' characterid='@{character_id}'" name="roll_attackweapon" >Combat</button>
            
            <button type="action" class="sheet-equip-button btn" name="act_equipment_equipitem_2">Equip</button>
            <button type="action" class="sheet-unequip-button btn" name="act_equipment_unequipitem_2">Unequip</button>
            <button type="roll" class="sheet-export-button" name="roll_exportitem" value="!!pickup  name=&#39;@{name}&#39;  type=&#39;@{type}&#39;  damage=&#39;@{damage}&#39;  weapontype=&#39;@{weapontype}&#39;  uses=&#39;@{uses}&#39;  description=&#39;@{description}&#39;  flavor=&#39;@{flavor}&#39;  characterid=@{target|Target 1|character_id}'" >Trade Item</button>
            <button type="action" class="sheet-delete-button btn-danger" name="act_equipment_deleteitem_2">Delete</button>
        </div>
    </div>

                    </div>
                </div>
             
                <div class="sheet-slot sheet-slot-3">
                    
                    <input type="checkbox" class="slot-control sheet-hidden" name="attr_equipment_3"/>
                    <div class="sheet-empty-text">Unused Slot</div>
                    <div class="slot-content">
                        

    <div class="sheet-card">
        
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-inventory" name="attr_equipment_type_3" value="inventory" />
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-weapon" name="attr_equipment_type_3" value="weapon" />
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-equipment" name="attr_equipment_type_3" value="equipment" checked/>
        

        
        <div class="sheet-card-type">
            <select class="sheet-shy" name="attr_equipment_type_3">
                
                    <option value="inventory" >Consumable </option>
                
                    <option value="weapon" >Weapon</option>
                
                    <option value="equipment"  selected="selected" >Equipment</option>
                
            </select>            
            <select class="sheet-shy sheet-weapon-only" name="attr_equipment_weapontype_3">
                
                    <option value="melee"  selected="selected" >Melee</option>
                
                    <option value="ranged" >Ranged</option>
                
            </select>
        </div>

        
        
            <input type="checkbox" class="sheet-hidden sheet-show-melee" name="attr_equipment_weapontype_3" value="melee" checked/>
        
            <input type="checkbox" class="sheet-hidden sheet-show-ranged" name="attr_equipment_weapontype_3" value="ranged" />
        

        
        <div class="sheet-card-name">
            <input type="text" name="attr_equipment_name_3" placeholder="Item Name">
        </div>

        
        <div class="sheet-card-weapon-fields">        
            
            
            <div class="sheet-card-damage  sheet-card-line">
                <div class="sheet-label">Damage:</div>
                <input class="sheet-shy" type="text" name="attr_equipment_damage_3" value="0" />
            </div>

            
            <div class="sheet-card-uses sheet-card-line">
                <div class="sheet-label sheet-ranged-only">Ammo:</div>
                <div class="sheet-label sheet-melee-only">Durability:</div>
                <div class="sheet-max">
                    <div>
                        <input type="text" class="sheet-number sheet-shy" name="attr_equipment_uses_3" value="0"/>
                    </div>
                    <div class="sheet-divider">/</div>
                    <div>
                        <input type="text" class="sheet-number sheet-shy" name="attr_equipment_uses_max_3" value="0"/>
                    </div>
                </div>
            </div>

            
            

        </div>

        <div class="sheet-card-textarea">
            <textarea class="sheet-shy" name="attr_equipment_description_3"></textarea>
            <input type="text" class="sheet-hidden" name="attr_equipment_flavor_3"/>
            <span readonly name="attr_equipment_flavor_3"></span>
        </div>
        <div class="sheet-card-actions">
            
            
            
            
            <button type="roll" class="sheet-attack-button sheet-attack-melee btn" value="!!combat success='?{Number of Attacks | @{ap_rolls}}' guard='?{Number of Defense Rolls | @{ap_rolls}}' sdice='@{equipment_damage_3}' gdice='d@{}' sbonus='@{melee_skill}' gbonus='@{}' weaponname='@{equipment_name_3}' type='@{equipment_weapontype_3}' sresource='equipment_uses_3'  limit='@{ap}' characterid='@{character_id}'" name="roll_attackweapon" >Combat</button>
            <button type="roll" class="sheet-attack-button sheet-attack-ranged btn" value="!!combat success='?{Number of Attacks | @{ap_rolls}}' guard='?{Number of Defense Rolls | @{ap_rolls}}' sdice='@{equipment_damage_3}' gdice='d@{}' sbonus='@{ranged_skill}' gbonus='@{}' weaponname='@{equipment_name_3}' type='@{equipment_weapontype_3}' sresource='equipment_uses_3'  limit='@{ap}' characterid='@{character_id}'" name="roll_attackweapon" >Combat</button>
            
            <button type="action" class="sheet-equip-button btn" name="act_equipment_equipitem_3">Equip</button>
            <button type="action" class="sheet-unequip-button btn" name="act_equipment_unequipitem_3">Unequip</button>
            <button type="roll" class="sheet-export-button" name="roll_exportitem" value="!!pickup  name=&#39;@{name}&#39;  type=&#39;@{type}&#39;  damage=&#39;@{damage}&#39;  weapontype=&#39;@{weapontype}&#39;  uses=&#39;@{uses}&#39;  description=&#39;@{description}&#39;  flavor=&#39;@{flavor}&#39;  characterid=@{target|Target 1|character_id}'" >Trade Item</button>
            <button type="action" class="sheet-delete-button btn-danger" name="act_equipment_deleteitem_3">Delete</button>
        </div>
    </div>

                    </div>
                </div>
             
                <div class="sheet-slot sheet-slot-4">
                    
                    <input type="checkbox" class="slot-control sheet-hidden" name="attr_equipment_4"/>
                    <div class="sheet-empty-text">Unused Slot</div>
                    <div class="slot-content">
                        

    <div class="sheet-card">
        
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-inventory" name="attr_equipment_type_4" value="inventory" />
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-weapon" name="attr_equipment_type_4" value="weapon" />
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-equipment" name="attr_equipment_type_4" value="equipment" checked/>
        

        
        <div class="sheet-card-type">
            <select class="sheet-shy" name="attr_equipment_type_4">
                
                    <option value="inventory" >Consumable </option>
                
                    <option value="weapon" >Weapon</option>
                
                    <option value="equipment"  selected="selected" >Equipment</option>
                
            </select>            
            <select class="sheet-shy sheet-weapon-only" name="attr_equipment_weapontype_4">
                
                    <option value="melee"  selected="selected" >Melee</option>
                
                    <option value="ranged" >Ranged</option>
                
            </select>
        </div>

        
        
            <input type="checkbox" class="sheet-hidden sheet-show-melee" name="attr_equipment_weapontype_4" value="melee" checked/>
        
            <input type="checkbox" class="sheet-hidden sheet-show-ranged" name="attr_equipment_weapontype_4" value="ranged" />
        

        
        <div class="sheet-card-name">
            <input type="text" name="attr_equipment_name_4" placeholder="Item Name">
        </div>

        
        <div class="sheet-card-weapon-fields">        
            
            
            <div class="sheet-card-damage  sheet-card-line">
                <div class="sheet-label">Damage:</div>
                <input class="sheet-shy" type="text" name="attr_equipment_damage_4" value="0" />
            </div>

            
            <div class="sheet-card-uses sheet-card-line">
                <div class="sheet-label sheet-ranged-only">Ammo:</div>
                <div class="sheet-label sheet-melee-only">Durability:</div>
                <div class="sheet-max">
                    <div>
                        <input type="text" class="sheet-number sheet-shy" name="attr_equipment_uses_4" value="0"/>
                    </div>
                    <div class="sheet-divider">/</div>
                    <div>
                        <input type="text" class="sheet-number sheet-shy" name="attr_equipment_uses_max_4" value="0"/>
                    </div>
                </div>
            </div>

            
            

        </div>

        <div class="sheet-card-textarea">
            <textarea class="sheet-shy" name="attr_equipment_description_4"></textarea>
            <input type="text" class="sheet-hidden" name="attr_equipment_flavor_4"/>
            <span readonly name="attr_equipment_flavor_4"></span>
        </div>
        <div class="sheet-card-actions">
            
            
            
            
            <button type="roll" class="sheet-attack-button sheet-attack-melee btn" value="!!combat success='?{Number of Attacks | @{ap_rolls}}' guard='?{Number of Defense Rolls | @{ap_rolls}}' sdice='@{equipment_damage_4}' gdice='d@{}' sbonus='@{melee_skill}' gbonus='@{}' weaponname='@{equipment_name_4}' type='@{equipment_weapontype_4}' sresource='equipment_uses_4'  limit='@{ap}' characterid='@{character_id}'" name="roll_attackweapon" >Combat</button>
            <button type="roll" class="sheet-attack-button sheet-attack-ranged btn" value="!!combat success='?{Number of Attacks | @{ap_rolls}}' guard='?{Number of Defense Rolls | @{ap_rolls}}' sdice='@{equipment_damage_4}' gdice='d@{}' sbonus='@{ranged_skill}' gbonus='@{}' weaponname='@{equipment_name_4}' type='@{equipment_weapontype_4}' sresource='equipment_uses_4'  limit='@{ap}' characterid='@{character_id}'" name="roll_attackweapon" >Combat</button>
            
            <button type="action" class="sheet-equip-button btn" name="act_equipment_equipitem_4">Equip</button>
            <button type="action" class="sheet-unequip-button btn" name="act_equipment_unequipitem_4">Unequip</button>
            <button type="roll" class="sheet-export-button" name="roll_exportitem" value="!!pickup  name=&#39;@{name}&#39;  type=&#39;@{type}&#39;  damage=&#39;@{damage}&#39;  weapontype=&#39;@{weapontype}&#39;  uses=&#39;@{uses}&#39;  description=&#39;@{description}&#39;  flavor=&#39;@{flavor}&#39;  characterid=@{target|Target 1|character_id}'" >Trade Item</button>
            <button type="action" class="sheet-delete-button btn-danger" name="act_equipment_deleteitem_4">Delete</button>
        </div>
    </div>

                    </div>
                </div>
             
                <div class="sheet-slot sheet-slot-5">
                    
                    <input type="checkbox" class="slot-control sheet-hidden" name="attr_equipment_5"/>
                    <div class="sheet-empty-text">Unused Slot</div>
                    <div class="slot-content">
                        

    <div class="sheet-card">
        
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-inventory" name="attr_equipment_type_5" value="inventory" />
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-weapon" name="attr_equipment_type_5" value="weapon" />
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-equipment" name="attr_equipment_type_5" value="equipment" checked/>
        

        
        <div class="sheet-card-type">
            <select class="sheet-shy" name="attr_equipment_type_5">
                
                    <option value="inventory" >Consumable </option>
                
                    <option value="weapon" >Weapon</option>
                
                    <option value="equipment"  selected="selected" >Equipment</option>
                
            </select>            
            <select class="sheet-shy sheet-weapon-only" name="attr_equipment_weapontype_5">
                
                    <option value="melee"  selected="selected" >Melee</option>
                
                    <option value="ranged" >Ranged</option>
                
            </select>
        </div>

        
        
            <input type="checkbox" class="sheet-hidden sheet-show-melee" name="attr_equipment_weapontype_5" value="melee" checked/>
        
            <input type="checkbox" class="sheet-hidden sheet-show-ranged" name="attr_equipment_weapontype_5" value="ranged" />
        

        
        <div class="sheet-card-name">
            <input type="text" name="attr_equipment_name_5" placeholder="Item Name">
        </div>

        
        <div class="sheet-card-weapon-fields">        
            
            
            <div class="sheet-card-damage  sheet-card-line">
                <div class="sheet-label">Damage:</div>
                <input class="sheet-shy" type="text" name="attr_equipment_damage_5" value="0" />
            </div>

            
            <div class="sheet-card-uses sheet-card-line">
                <div class="sheet-label sheet-ranged-only">Ammo:</div>
                <div class="sheet-label sheet-melee-only">Durability:</div>
                <div class="sheet-max">
                    <div>
                        <input type="text" class="sheet-number sheet-shy" name="attr_equipment_uses_5" value="0"/>
                    </div>
                    <div class="sheet-divider">/</div>
                    <div>
                        <input type="text" class="sheet-number sheet-shy" name="attr_equipment_uses_max_5" value="0"/>
                    </div>
                </div>
            </div>

            
            

        </div>

        <div class="sheet-card-textarea">
            <textarea class="sheet-shy" name="attr_equipment_description_5"></textarea>
            <input type="text" class="sheet-hidden" name="attr_equipment_flavor_5"/>
            <span readonly name="attr_equipment_flavor_5"></span>
        </div>
        <div class="sheet-card-actions">
            
            
            
            
            <button type="roll" class="sheet-attack-button sheet-attack-melee btn" value="!!combat success='?{Number of Attacks | @{ap_rolls}}' guard='?{Number of Defense Rolls | @{ap_rolls}}' sdice='@{equipment_damage_5}' gdice='d@{}' sbonus='@{melee_skill}' gbonus='@{}' weaponname='@{equipment_name_5}' type='@{equipment_weapontype_5}' sresource='equipment_uses_5'  limit='@{ap}' characterid='@{character_id}'" name="roll_attackweapon" >Combat</button>
            <button type="roll" class="sheet-attack-button sheet-attack-ranged btn" value="!!combat success='?{Number of Attacks | @{ap_rolls}}' guard='?{Number of Defense Rolls | @{ap_rolls}}' sdice='@{equipment_damage_5}' gdice='d@{}' sbonus='@{ranged_skill}' gbonus='@{}' weaponname='@{equipment_name_5}' type='@{equipment_weapontype_5}' sresource='equipment_uses_5'  limit='@{ap}' characterid='@{character_id}'" name="roll_attackweapon" >Combat</button>
            
            <button type="action" class="sheet-equip-button btn" name="act_equipment_equipitem_5">Equip</button>
            <button type="action" class="sheet-unequip-button btn" name="act_equipment_unequipitem_5">Unequip</button>
            <button type="roll" class="sheet-export-button" name="roll_exportitem" value="!!pickup  name=&#39;@{name}&#39;  type=&#39;@{type}&#39;  damage=&#39;@{damage}&#39;  weapontype=&#39;@{weapontype}&#39;  uses=&#39;@{uses}&#39;  description=&#39;@{description}&#39;  flavor=&#39;@{flavor}&#39;  characterid=@{target|Target 1|character_id}'" >Trade Item</button>
            <button type="action" class="sheet-delete-button btn-danger" name="act_equipment_deleteitem_5">Delete</button>
        </div>
    </div>

                    </div>
                </div>
             
                <div class="sheet-slot sheet-slot-6">
                    
                    <input type="checkbox" class="slot-control sheet-hidden" name="attr_equipment_6"/>
                    <div class="sheet-empty-text">Unused Slot</div>
                    <div class="slot-content">
                        

    <div class="sheet-card">
        
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-inventory" name="attr_equipment_type_6" value="inventory" />
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-weapon" name="attr_equipment_type_6" value="weapon" />
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-equipment" name="attr_equipment_type_6" value="equipment" checked/>
        

        
        <div class="sheet-card-type">
            <select class="sheet-shy" name="attr_equipment_type_6">
                
                    <option value="inventory" >Consumable </option>
                
                    <option value="weapon" >Weapon</option>
                
                    <option value="equipment"  selected="selected" >Equipment</option>
                
            </select>            
            <select class="sheet-shy sheet-weapon-only" name="attr_equipment_weapontype_6">
                
                    <option value="melee"  selected="selected" >Melee</option>
                
                    <option value="ranged" >Ranged</option>
                
            </select>
        </div>

        
        
            <input type="checkbox" class="sheet-hidden sheet-show-melee" name="attr_equipment_weapontype_6" value="melee" checked/>
        
            <input type="checkbox" class="sheet-hidden sheet-show-ranged" name="attr_equipment_weapontype_6" value="ranged" />
        

        
        <div class="sheet-card-name">
            <input type="text" name="attr_equipment_name_6" placeholder="Item Name">
        </div>

        
        <div class="sheet-card-weapon-fields">        
            
            
            <div class="sheet-card-damage  sheet-card-line">
                <div class="sheet-label">Damage:</div>
                <input class="sheet-shy" type="text" name="attr_equipment_damage_6" value="0" />
            </div>

            
            <div class="sheet-card-uses sheet-card-line">
                <div class="sheet-label sheet-ranged-only">Ammo:</div>
                <div class="sheet-label sheet-melee-only">Durability:</div>
                <div class="sheet-max">
                    <div>
                        <input type="text" class="sheet-number sheet-shy" name="attr_equipment_uses_6" value="0"/>
                    </div>
                    <div class="sheet-divider">/</div>
                    <div>
                        <input type="text" class="sheet-number sheet-shy" name="attr_equipment_uses_max_6" value="0"/>
                    </div>
                </div>
            </div>

            
            

        </div>

        <div class="sheet-card-textarea">
            <textarea class="sheet-shy" name="attr_equipment_description_6"></textarea>
            <input type="text" class="sheet-hidden" name="attr_equipment_flavor_6"/>
            <span readonly name="attr_equipment_flavor_6"></span>
        </div>
        <div class="sheet-card-actions">
            
            
            
            
            <button type="roll" class="sheet-attack-button sheet-attack-melee btn" value="!!combat success='?{Number of Attacks | @{ap_rolls}}' guard='?{Number of Defense Rolls | @{ap_rolls}}' sdice='@{equipment_damage_6}' gdice='d@{}' sbonus='@{melee_skill}' gbonus='@{}' weaponname='@{equipment_name_6}' type='@{equipment_weapontype_6}' sresource='equipment_uses_6'  limit='@{ap}' characterid='@{character_id}'" name="roll_attackweapon" >Combat</button>
            <button type="roll" class="sheet-attack-button sheet-attack-ranged btn" value="!!combat success='?{Number of Attacks | @{ap_rolls}}' guard='?{Number of Defense Rolls | @{ap_rolls}}' sdice='@{equipment_damage_6}' gdice='d@{}' sbonus='@{ranged_skill}' gbonus='@{}' weaponname='@{equipment_name_6}' type='@{equipment_weapontype_6}' sresource='equipment_uses_6'  limit='@{ap}' characterid='@{character_id}'" name="roll_attackweapon" >Combat</button>
            
            <button type="action" class="sheet-equip-button btn" name="act_equipment_equipitem_6">Equip</button>
            <button type="action" class="sheet-unequip-button btn" name="act_equipment_unequipitem_6">Unequip</button>
            <button type="roll" class="sheet-export-button" name="roll_exportitem" value="!!pickup  name=&#39;@{name}&#39;  type=&#39;@{type}&#39;  damage=&#39;@{damage}&#39;  weapontype=&#39;@{weapontype}&#39;  uses=&#39;@{uses}&#39;  description=&#39;@{description}&#39;  flavor=&#39;@{flavor}&#39;  characterid=@{target|Target 1|character_id}'" >Trade Item</button>
            <button type="action" class="sheet-delete-button btn-danger" name="act_equipment_deleteitem_6">Delete</button>
        </div>
    </div>

                    </div>
                </div>
            
        </div>
    </div>


        </div>

        </div>
        <div class="sheet-sidebar">
            

    <div class="sheet-bubble extra-bottom">
        <div class="sheet-title">
            
                Ammo
            
        </div>

        <div class="sheet-content">
            
                    
    <div class="sheet-list">
        
            <div class="sheet-line">
                <div class="sheet-label">Arrows</div>
                <input type="text" class="sheet-number" name="attr_ammo_arrow" value="0"/>
            </div>
        
            <div class="sheet-line">
                <div class="sheet-label">Bolts</div>
                <input type="text" class="sheet-number" name="attr_ammo_bolt" value="0"/>
            </div>
        
            <div class="sheet-line">
                <div class="sheet-label">Heavy</div>
                <input type="text" class="sheet-number" name="attr_ammo_heavy" value="0"/>
            </div>
        
            <div class="sheet-line">
                <div class="sheet-label">Light</div>
                <input type="text" class="sheet-number" name="attr_ammo_light" value="0"/>
            </div>
        
            <div class="sheet-line">
                <div class="sheet-label">Medium</div>
                <input type="text" class="sheet-number" name="attr_ammo_medium" value="0"/>
            </div>
        
    </div>

                
        </div>
    </div>

            

    <div class="sheet-bubble extra-bottom">
        <div class="sheet-title">
            
                Combat Skills
            
        </div>

        <div class="sheet-content">
            
                    
    <div class="sheet-list">
        
            <div class="sheet-line">
                <div class="sheet-label">Guard</div>
                <input type="text" class="sheet-number" name="attr_guard_skill" value="3"/>
            </div>
        
            <div class="sheet-line">
                <div class="sheet-label">Melee</div>
                <input type="text" class="sheet-number" name="attr_melee_skill" value="3"/>
            </div>
        
            <div class="sheet-line">
                <div class="sheet-label">Ranged</div>
                <input type="text" class="sheet-number" name="attr_ranged_skill" value="3"/>
            </div>
        
            <div class="sheet-line">
                <div class="sheet-label">Throw</div>
                <input type="text" class="sheet-number" name="attr_throw_skill" value="3"/>
            </div>
        
    </div>

                
        </div>
    </div>

            

    <div class="sheet-bubble extra-bottom">
        <div class="sheet-title">
            
                Skills
            
        </div>

        <div class="sheet-content">
            
                    
    <div class="sheet-list">
        
            <div class="sheet-line">
                <div class="sheet-label">Athletics</div>
                <input type="text" class="sheet-number" name="attr_athletics_skill" value="0"/>
            </div>
        
            <div class="sheet-line">
                <div class="sheet-label">Construction</div>
                <input type="text" class="sheet-number" name="attr_construction_skill" value="0"/>
            </div>
        
            <div class="sheet-line">
                <div class="sheet-label">First Aid</div>
                <input type="text" class="sheet-number" name="attr_firstaid_skill" value="0"/>
            </div>
        
            <div class="sheet-line">
                <div class="sheet-label">Hacking</div>
                <input type="text" class="sheet-number" name="attr_hacking_skill" value="0"/>
            </div>
        
            <div class="sheet-line">
                <div class="sheet-label">Lockpick</div>
                <input type="text" class="sheet-number" name="attr_lockpick_skill" value="0"/>
            </div>
        
            <div class="sheet-line">
                <div class="sheet-label">Scout</div>
                <input type="text" class="sheet-number" name="attr_scout_skill" value="0"/>
            </div>
        
            <div class="sheet-line">
                <div class="sheet-label">Socialize</div>
                <input type="text" class="sheet-number" name="attr_social_skill" value="0"/>
            </div>
        
            <div class="sheet-line">
                <div class="sheet-label">Stealth</div>
                <input type="text" class="sheet-number" name="attr_stealth_skill" value="0"/>
            </div>
        
    </div>

                
        </div>
    </div>

        </div>
    </div>
        <div class="sheet-inventory">
        <div class="sheet-slot-section">
            <div class="sheet-row-flex sheet-label-row">
                <label>Inventory</label>
                <div class="sheet-subtext">
                    Slots:
                    <input type="text" class="sheet-number sheet-shy" name="attr_inventory" value="5"/>
                </div>
            </div>
            <fieldset class="repeating_inventory">
                <div class="sheet-slot">
                    

    <div class="sheet-card">
        
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-inventory" name="attr_type" value="inventory" />
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-weapon" name="attr_type" value="weapon" />
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-equipment" name="attr_type" value="equipment" />
        

        
        <div class="sheet-card-type">
            <select class="sheet-shy" name="attr_type">
                
                    <option value="inventory" >Consumable </option>
                
                    <option value="weapon" >Weapon</option>
                
                    <option value="equipment" >Equipment</option>
                
            </select>            
            <select class="sheet-shy sheet-weapon-only" name="attr_weapontype">
                
                    <option value="melee"  selected="selected" >Melee</option>
                
                    <option value="ranged" >Ranged</option>
                
            </select>
        </div>

        
        
            <input type="checkbox" class="sheet-hidden sheet-show-melee" name="attr_weapontype" value="melee" checked/>
        
            <input type="checkbox" class="sheet-hidden sheet-show-ranged" name="attr_weapontype" value="ranged" />
        

        
        <div class="sheet-card-name">
            <input type="text" name="attr_name" placeholder="Item Name">
        </div>

        
        <div class="sheet-card-weapon-fields">        
            
            
            <div class="sheet-card-damage  sheet-card-line">
                <div class="sheet-label">Damage:</div>
                <input class="sheet-shy" type="text" name="attr_damage" value="0" />
            </div>

            
            <div class="sheet-card-uses sheet-card-line">
                <div class="sheet-label sheet-ranged-only">Ammo:</div>
                <div class="sheet-label sheet-melee-only">Durability:</div>
                <div class="sheet-max">
                    <div>
                        <input type="text" class="sheet-number sheet-shy" name="attr_uses" value="0"/>
                    </div>
                    <div class="sheet-divider">/</div>
                    <div>
                        <input type="text" class="sheet-number sheet-shy" name="attr_uses_max" value="0"/>
                    </div>
                </div>
            </div>

            
            

        </div>

        <div class="sheet-card-textarea">
            <textarea class="sheet-shy" name="attr_description"></textarea>
            <input type="text" class="sheet-hidden" name="attr_flavor"/>
            <span readonly name="attr_flavor"></span>
        </div>
        <div class="sheet-card-actions">
            
            
            
            
            <button type="roll" class="sheet-attack-button sheet-attack-melee btn" value="!!combat success='?{Number of Attacks | @{ap_rolls}}' guard='?{Number of Defense Rolls | @{ap_rolls}}' sdice='@{damage}' gdice='d@{}' sbonus='@{melee_skill}' gbonus='@{}' weaponname='@{name}' type='@{weapontype}' sresource='uses'  limit='@{ap}' characterid='@{character_id}'" name="roll_attackweapon" >Combat</button>
            <button type="roll" class="sheet-attack-button sheet-attack-ranged btn" value="!!combat success='?{Number of Attacks | @{ap_rolls}}' guard='?{Number of Defense Rolls | @{ap_rolls}}' sdice='@{damage}' gdice='d@{}' sbonus='@{ranged_skill}' gbonus='@{}' weaponname='@{name}' type='@{weapontype}' sresource='uses'  limit='@{ap}' characterid='@{character_id}'" name="roll_attackweapon" >Combat</button>
            
            <button type="action" class="sheet-equip-button btn" name="act_equipitem">Equip</button>
            <button type="action" class="sheet-unequip-button btn" name="act_unequipitem">Unequip</button>
            <button type="roll" class="sheet-export-button" name="roll_exportitem" value="!!pickup  name=&#39;@{name}&#39;  type=&#39;@{type}&#39;  damage=&#39;@{damage}&#39;  weapontype=&#39;@{weapontype}&#39;  uses=&#39;@{uses}&#39;  description=&#39;@{description}&#39;  flavor=&#39;@{flavor}&#39;  characterid=@{target|Target 1|character_id}'" >Trade Item</button>
            <button type="action" class="sheet-delete-button btn-danger" name="act_deleteitem">Delete</button>
        </div>
    </div>

                </div>
            </fieldset>
        </div>
    </div> 
    <div class="sheet-bottom">
        <div class="sheet-ap-pool">
        
        </div>
    </div>
</div>



<rolltemplate class="sheet-rolltemplate-zroll">
    <div class="sheet-template-container" style="border: solid 2px black; padding: 5px">
        <div class="sheet-zroll-header" style="color: white; background-color: purple; padding: 5px; font-weight: 900; border: solid 3px black">
            {{name}}
        </div>
        <div class="zroll-row" style="font-size: 10px; font-style: italics; padding: 5px 10px;">
            {{description}}
        </div>
        <div class="sheet-zroll-row" style="border: solid 1px black;">
            <div class="sheet-zroll-result" style="display:inline-block; width: 30%; padding: 8%; box-sizing: border-box; border-right: solid 1px black; margin: 5px 0;">
                <strong style="display: block; text-align: center; margin-bottom: 10px;">{{successlabel}}</strong>
                <div style="font-size: 24px; font-weight: 900; text-align: center; margin-bottom: 20px;">{{success}}</div>

                <div class="sheet-zroll-rolls" style="text-align: center;">
                    {{successrolls}}
                </div>
            </div>
            <div class="sheet-zroll-result" style="display:inline-block; width: 30%; padding: 8%; box-sizing: border-box; margin: 5px 0;">
                <strong style="display: block; text-align: center; margin-bottom: 10px;">{{guardlabel}}</strong>
                <div style="font-size: 24px; font-weight: 900; text-align: center; margin-bottom: 20px;">{{guard}}</div>

                <div class="sheet-zroll-rolls" style="text-align: center;">
                    {{guardrolls}}
                </div>
            </div>
        </div>
    </div>
</rolltemplate>


<script type="text/worker">
    /** inject:workers **/
    (function () {
    'use strict';

    var abc = {
    	id: "selectability",
    	label: "Select an Ability",
    	description: ""
    };
    var parkour = {
    	id: "Speedster",
    	description: "You can move 3 spaces at no cost on your turn."
    };
    var brawler = {
    	id: "brawler",
    	description: "Any excess guard is dealt as damage."
    };
    var cheerleader = {
    	id: "cheerleader",
    	description: "Reduce difficulty of roll for adjacent allies by 1 level."
    };
    var builder = {
    	id: "builder",
    	description: "Create a distraction device by spending 1 AP and 1 Item. The device will attract common zombies towards it for some time."
    };
    var scavenger = {
    	id: "scavenger",
    	description: "Draw 1 additional cards when you scavenge. If you are scavenging a location alone, draw 3."
    };
    var sniper = {
    	id: "sniper",
    	description: "If you don't attack this turn, you can make a free attack roll and add that to next turn's ranged attack."
    };
    var prepared = {
    	id: "prepared",
    	label: "Doomsday Prep",
    	description: "Start the game with 5 free scavenge actions and 2 additional equipment slots."
    };
    var abilities = {
    	abc: abc,
    	parkour: parkour,
    	brawler: brawler,
    	cheerleader: cheerleader,
    	builder: builder,
    	scavenger: scavenger,
    	sniper: sniper,
    	prepared: prepared
    };

    var abilities$1 = /*#__PURE__*/Object.freeze({
        __proto__: null,
        abc: abc,
        parkour: parkour,
        brawler: brawler,
        cheerleader: cheerleader,
        builder: builder,
        scavenger: scavenger,
        sniper: sniper,
        prepared: prepared,
        'default': abilities
    });

    const fields$1 = {
        notes: {
            id: "notes",
            type: "textarea"
        },
        ammo: {
            id: "ammo",
            type: "list",
            default: 0,
            options: {
                light: {
                    id: "ammo_light",
                    bundle: 30,
                    label: "Light"
                },
                medium: {
                    id: "ammo_medium",
                    bundle: 30,
                    label: "Medium"
                },
                heavy: {
                    id: "ammo_heavy",
                    bundle: 30,
                    label: "Heavy"
                },
                bolt: {
                    id: "ammo_bolt",
                    bundle: 5,
                    label: "Bolts"
                },
                arrow: {
                    id: "ammo_arrow",
                    bundle: 5,
                    label: "Arrows"
                }
            }
        },
        stats: {
            hp: {
                id: "hp",
                default: 30,
                type: "max",
                label: "HP"
            },
            ap: {
                id: "ap",
                default: 15,
                type: "max",
                label: "AP",
                rollable: true,
                pool: 'ap_pool'
            },
        },
        combatskills: {
            id: "combatskills",
            type: "list",
            label: "Combat Skills",
            default: 3,
            options: {
                guard: {
                    id: "guard_skill",
                    label: "Guard"
                },
                throw: {
                    id: "throw_skill",
                    label: "Throw"
                },
                melee: {
                    id: "melee_skill",
                    label: "Melee"
                },
                ranged: {
                    id: "ranged_skill",
                    label: "Ranged"
                }
            }
        },
        skills: {
            id: "skills",
            type: "list",
            label: "Skills",
            default: 0,
            options: {
                lockpick: {
                    id: "lockpick_skill",
                    label: "Lockpick"
                },
                scout: {
                    id: "scout_skill",
                    label: "Scout"
                },
                stealth: {
                    id: "stealth_skill",
                    label: "Stealth"
                },
                social: {
                    id: "social_skill",
                    label: "Socialize"
                },
                firstaid: {
                    id: "firstaid_skill",
                    label: "First Aid"
                },
                construction: {
                    id: "construction_skill",
                    label: "Construction"
                },
                hacking: {
                    id: "hacking_skill",
                    label: "Hacking"
                },
                athletics: {
                    id: "athletics_skill",
                    label: "Athletics"
                }
            }
        },
        ability: {
            id: "ability",
            type: "toggleselect",
            options: abilities$1
        },
        // weaponslots: {
        //     id: "weaponslots",
        //     label: "Weapons",
        //     default: 1,
        //     max: 3,
        //     type: "weapon"
        // },
        equipmentslots: {
            id: "equipmentslots",
            default: 2,
            max: 6,
            type: "equipment",
            label: "Equipment"
        },
        inventory: {
            id: "inventory",
            default: 5,
            max: 12,
            label: "Inventory"
        }
    };

    const fields = {
        name: {
            id: 'name'
        },
        type: {
            id: 'type',
            label: "Item Type",
            options: [
                'inventory',
                'weapon',
                'equipment'
            ]
        },
        damage: {
            id: 'damage'
        },
        weapontype: {
            id: 'weapontype',
            options: [
                'melee',
                'ranged'
            ],
            label: 'Weapon Type',
            default: 'melee'
        },
        uses: {
            id: 'uses',
            max: 'uses_max', // easier to handle ids and indexflight from rochesbalti
            labels: {
                melee: 'Durability',
                ranged: 'Ammo'
            }
        },
        // ammotype: {
        //     id: 'ammotype',
        //     label: 'Ammo Type'
        // },
        description: {
            id: 'description'
        }, 
        flavor: {
            id: 'flavor'
        },
    };


    const options = {
        actions: {
            export:'exportitem', 
            delete:'deleteitem',
            attack:'attackweapon',
            reload: 'reloadweapon',
            equip: 'equipitem',
            unequip: 'unequipitem'
        }
    };

    const getButtonRowId = function(eventInfo){
        var underscoreIndex = eventInfo.sourceAttribute.lastIndexOf("_");
        return eventInfo.sourceAttribute.substr(0, underscoreIndex);
    };

    /**
     * Given a number, spread it out and list all numbers preceding it.
     */
     const sequenceNumber = (num, delim='', flip=false) => {
        var result = '';

        if (!Number.isInteger(num)){
            return '';
        }

        //descending order
        if (flip){
            for (let i = num; i >= 0; i--){
                result += i.toString();
        
                if (i > 0 && delim.length){
                    result += delim;
                }
            }
        } else {
            //ascneding order
            for (let i = 0; i <= num; i++){
                result += i.toString();
        
                if (i < num && delim.length){
                    result += delim;
                }
            }
        }

        return result;
    };

    function deleteItem(){
        on(`clicked:repeating_${fields$1.inventory.id}:${options.actions.delete}`, function(evInfo){
            const rowId = getButtonRowId(evInfo);
            removeRepeatingRow(rowId);
        });
    }

    /**
     * IDs
     * - equipmentslots (slotsId): stores the current number of slots.
     * - equipment_{x}: whether slot is active or not
     */

    function equip(itemCardFields = fields){
        //pull data into variables for easier interchangeability
        let itemFields = {...itemCardFields},
            slotsId = fields$1.equipmentslots.id,
            equipId = fields$1.equipmentslots.type,
            maxSlots = fields$1.equipmentslots.max,
            inventoryId = fields$1.inventory.id,
            equipPrefix = fields$1.equipmentslots.type,
            unequipAction = options.actions.unequip,
            equipAction = options.actions.equip;

        

        /**
         * Gets all available item slot IDs
         */
        const getSlotFields = function(){
            let result = [];

            // 1 - indexed
            for (let i = 1; i <= maxSlots; i++){
                result.push(equipId + '_' + i);
            }
            return result;
        };

        /**
         * Gets an array of all item field Ids.
         * 
         * @param {*} suffix - if present, adds it to the end of the field with preceeding underscore.
         * @returns array of Id strings.
         */
        const getItemFieldIds = function(suffix, prefix, fields=itemFields){
            let result = [];
            
            const affix = function(str){
                let result = str;

                if (suffix && suffix.toString().length){
                    result = result + '_' + suffix;
                }

                if (prefix && prefix.length){
                    result = prefix + '_' + result;
                }

                return result;
            };

            for (const key in fields){
                let fld = fields[key],
                    id = affix(fld.id);

                result.push(id);

                if ('max' in fld && fld.max.length){
                    result.push(affix(fld.max));
                }
            }

            return result;
        };

        /**
         * Generates a setAttrs object for an empty equipment object
         * 
         * @param {*} fields - in case you need custom fields for testing or something.
         */
        const generateBlankEquipmentObj = function(id, fields=itemFields){

            let result = {};
            
            for (const key in fields){
                const fld = fields[key],
                    newKey = equipPrefix + '_' + key + '_' + id;


                if ('default' in fld){
                    result[newKey] = fld.default;
                } else {
                    result[newKey] = '';

                    if ('max' in fld){
                        result[fld.max + '_' + id] = '';
                    }
                }
            }
            return result;
        };

        /**
         * Remaps the values of an object to a modified version of its original key
         * 
         * @param {obj} obj - object to remap keys with text affixed to it
         * @param {text} affix - text to add to front or back when transposing
         * @param {bool} pre - add to front of key when transposing. Set false to add to back.
         * @param {fn} keyfn - callback function to allow additional modifications on the key. Is passed the key and it should return a string.
         */
        const remapKeys = function(obj, affix, pre=true, keyfn){
            const result = {};

            for (const key in obj){
                let keyText = key;

                if (keyfn){
                    keyText = keyfn(keyText);
                }

                const newKey = (pre ? `${affix}${keyText}` : `${keyText}${affix}`);
                result[newKey] = obj[key];
            }

            return result;
        };

        /**
         * Find next available slot.
         * 
         * @param {*} values values retrieved from getAttrs. Should contain all equipmentslots.
         * @returns the Index number of the slot
         */
        const findNextAvailableSlotIndex = function(values){
            if (slotsId in values){
                //only check up to the character's currently number of slots
                let max = values[slotsId];
        
                //Find next open slot and return.
                for (let i = 1; i <= max; i++){
                    if (values[equipId + '_' + i] == 0){
                        return i;
                    }
                }
            }

            return null;
        };

        /**
         * Unequip a given slot.
         * 
         * @param {*} slotIndex - Which slot to unequip
         */
        const unequipItem = function(slotIndex){
            //Get array of fields
            let unequipFields = getItemFieldIds(slotIndex, equipPrefix);
            
            getAttrs(unequipFields, function(values){
                const rowId = generateRowID(); 

                //create new inv item to create
                const newInvItem = remapKeys(values,  `repeating_${inventoryId}_${rowId}_`, true, function(x){ 
                    let result = x.replace('equipment_', '');
                    let last = result.lastIndexOf(`_${slotIndex}`); //lastIndex so we make sure to only get the end
                    
                    if (last > 0){
                        return result.substring(0, last);
                    } else {
                        return result;
                    }
                });
                
                //clear equipment fields
                const emptyEquipment = generateBlankEquipmentObj(slotIndex);

                const attrSet = {
                    ...newInvItem,
                    ...emptyEquipment
                };

                //make the slot available again.
                attrSet[`${equipId}_${slotIndex}`] = 0;
                console.log(attrSet);
                setAttrs(attrSet);
            });
        };


        const equipItem = function(rowId){
            // Get fields for both equipment and inventory and the id for equipment slots
            const bothFields = getItemFieldIds('', `repeating_${inventoryId}`)
                    .concat(getSlotFields());
                bothFields.push(slotsId);

            getAttrs(bothFields, function(values){
                // find availble slot
                let availableSlotIndex = findNextAvailableSlotIndex(values);

                //Slot is available!
                if (availableSlotIndex){
                    
                    //only consider inventory fields for remapping
                    let inventoryFields = Object.keys(values)
                        .filter(x => x.includes(`repeating_${inventoryId}`))
                        .reduce((obj, key) => {
                            obj[key] = values[key];
                            return obj;
                        }, {});

                
                    
                    //filter add index, filter out repeating_inventory
                    let newEquipment = remapKeys(inventoryFields, `_${availableSlotIndex}`, false, (x) => { return x.replace(`repeating_${inventoryId}_`, `${equipPrefix}_`);});
                    
                    const attrSet = {
                        ...newEquipment
                    };

                    // set slot to active
                    attrSet[equipId + '_' + availableSlotIndex] = 'on';

                    removeRepeatingRow(rowId); //remove current row
                    console.log(attrSet);
                    setAttrs(attrSet);
                } else {
                    console.log('No slot found!');
                }
            });
        };

        const init = function(){
            // Hooks for buttons
            on(`clicked:repeating_${inventoryId}:${equipAction}`, function(evInfo){
                const rowId = getButtonRowId(evInfo);
                equipItem(rowId);
            });
        
            for (let i = 1; i <= maxSlots; i++){
                on(`clicked:${equipId}_${unequipAction}_${i}`, function(){
                    unequipItem(i);
                });
            }
        };

        return {
            init: init,
            getItemFieldIds: getItemFieldIds,
            generateBlankEquipmentObj: generateBlankEquipmentObj,
            remapKeys:  remapKeys,
            findNextAvailableSlotIndex: findNextAvailableSlotIndex,
            getSlotFields: getSlotFields
        }
    }

    function limit(){
        on(`change:repeating_${fields$1.inventory.id}`, function(evInfo){

            //So we don't interfere with unequip script
            if (evInfo.sourceType == 'sheetworker'){
                return;
            }


            getAttrs([fields$1.inventory.id], function(values){
                let slots = parseInt(values[fields$1.inventory.id], 10);

                if (isNaN(slots)){
                    console.error('Error when parsing slots');
                    return;
                }

                getSectionIDs(fields$1.inventory.id, function(arr){

                    if (arr.length > slots){
                        let lastRow = arr[arr.length - 1]; //only remove the latest one, so we don't interfere with unequip
                        removeRepeatingRow(`repeating_${fields$1.inventory.id}_` + lastRow);
                    }
                });
            });
        });
    }

    //If a Stat is rollable, set a _rolls field to be a sequence of numbers
    //ie if stat is 5, set _rolls field to be 1|2|3|4|5
    //That way, we can use dropdowns for roll buttons based on the stats value
    function rollOptions(){
        for (let stat in fields$1.stats){
            let curStat = fields$1.stats[stat];

            if (curStat.rollable){
                let attr = curStat.id;
        
                on( 'change:' + attr, function(){
                    getAttrs([attr], function(values){
                        let numOfDice = parseInt(values[attr], 10);

                        var attrSet = {
                            [attr + '_rolls'] : sequenceNumber(numOfDice, '|', true) //start at value
                        };

                        // Add bonus options
                        for (let i = 1; i <= numOfDice; i++){
                            attrSet[attr + '_rolls'] += `| ${numOfDice }( + ${i} bonus rolls ), ${numOfDice}b${i}`;
                        }

                        setAttrs(attrSet);
                    });
                });
            }
        }

    }

    equip().init();
    limit();
    rollOptions();
    deleteItem();

})();

    /** endinject **/
</script>



