



<div class="sheet-character">
    


<div class="sheet-header">
    <div class="sheet-main">
        
        <div class="sheet-row-flex">
            
    <div class="sheet-bubble  sheet-top-1">
        <div class="sheet-content">
            <div class="sheet-row-flex sheet-space-around">
                
                    <div class="sheet-stat">
                        <label>HP </label>
                        <div class="sheet-max">
                            <div>
                                <input type="text" class="sheet-number sheet-shy" name="attr_hp" value="30"/>
                            </div>
                            <div class="sheet-divider">/</div>
                            <div>
                                <input type="text" class="sheet-number sheet-shy" name="attr_hp_max" value="30"/>
                            </div>

                            
                        </div>
                    </div>
                
                    <div class="sheet-stat">
                        <label>AP </label>
                        <div class="sheet-max">
                            <div>
                                <input type="text" class="sheet-number sheet-shy" name="attr_ap" value="5"/>
                            </div>
                            <div class="sheet-divider">/</div>
                            <div>
                                <input type="text" class="sheet-number sheet-shy" name="attr_ap_max" value="5"/>
                            </div>

                            
                            
                            <input type="text" class="sheet-hidden" name="attr_ap_rolls" value="5"/>
                            
                        </div>
                    </div>
                
            </div>
        </div>
    </div>

            

    <div class="sheet-bubble sheet-top-2">
        <div class="sheet-content">
            <label>Ability</label>

            
                    
    <div class="sheet-row-flex sheet-toggle-select">
        <div class="sheet-toggler">
            <select name="attr_ability">
                
                    <option value="" selected></option>
                
                    <option value="actionstar" >Action Star</option>
                
                    <option value="cheerleader" >Cheerleader</option>
                
                    <option value="brawler" >Brawler</option>
                
                    <option value="builder" >Builder</option>
                
                    <option value="doctor" >Doctor</option>
                
                    <option value="Reflexes" >Reflexes</option>
                
                    <option value="scavenger" >Scavenger</option>
                
                    <option value="scout" >Scout</option>
                
                    <option value="sniper" >Sniper</option>
                
                    <option value="tanky" >Tanky</option>
                
                    <option value="" ></option>
                
            </select>
        </div>

        <div class="sheet-text sheet-toggle-adj">
            
                <input type="checkbox" class="sheet-control" name="attr_ability" value="" checked />
                <div class="sheet-description-text sheet-content">
                    
                </div>
            
                <input type="checkbox" class="sheet-control" name="attr_ability" value="actionstar"  />
                <div class="sheet-description-text sheet-content">
                    Increase your max action points by 2
                </div>
            
                <input type="checkbox" class="sheet-control" name="attr_ability" value="cheerleader"  />
                <div class="sheet-description-text sheet-content">
                    <strong>Action:</strong> Give adjacent players a single bonus dice roll until your next turn.
                </div>
            
                <input type="checkbox" class="sheet-control" name="attr_ability" value="brawler"  />
                <div class="sheet-description-text sheet-content">
                    Adds 2 bonus rolls to any melee attack.
                </div>
            
                <input type="checkbox" class="sheet-control" name="attr_ability" value="builder"  />
                <div class="sheet-description-text sheet-content">
                    Use a D10 when building barricades and add 1 bonus dice roll.
                </div>
            
                <input type="checkbox" class="sheet-control" name="attr_ability" value="doctor"  />
                <div class="sheet-description-text sheet-content">
                    Use a D10 when restoring health and add 1 bonus dice roll.
                </div>
            
                <input type="checkbox" class="sheet-control" name="attr_ability" value="Reflexes"  />
                <div class="sheet-description-text sheet-content">
                    Use a D10 when doing defense rolls.
                </div>
            
                <input type="checkbox" class="sheet-control" name="attr_ability" value="scavenger"  />
                <div class="sheet-description-text sheet-content">
                    Whenever you scavenge, scavenge 1 additional item.
                </div>
            
                <input type="checkbox" class="sheet-control" name="attr_ability" value="scout"  />
                <div class="sheet-description-text sheet-content">
                    Gain better vision in the dark. Sense approaching enemies.
                </div>
            
                <input type="checkbox" class="sheet-control" name="attr_ability" value="sniper"  />
                <div class="sheet-description-text sheet-content">
                    Add +2 on every attack roll you make.
                </div>
            
                <input type="checkbox" class="sheet-control" name="attr_ability" value="tanky"  />
                <div class="sheet-description-text sheet-content">
                    Increase your starting health by 20.
                </div>
            
                <input type="checkbox" class="sheet-control" name="attr_ability" value=""  />
                <div class="sheet-description-text sheet-content">
                    
                </div>
            
        </div>
    </div>

                
        </div>
    </div>

        </div>

        
        <div class="sheet-row-flex">
            

    <div class="sheet-bubble sheet-bottom-1">
        <div class="sheet-content">
            <label>Defense</label>

            
                    
    <div class="sheet-dice-input">
        <div class="sheet-input">
            <span>d</span><input type="text" class="sheet-number sheet-shy" name="attr_defense" value="4"/>
        </div>
        <div class="sheet-divider">
            +
        </div>
        <div class="sheet-input">
            <input type="text" class="sheet-number sheet-shy" name="attr_defense_bonus" value="0"/>
        </div>
    </div>

                
        </div>
    </div>

            

    <div class="sheet-bubble sheet-bottom-2">
        <div class="sheet-content">
            <label>Notes</label>

            
                    
    <textarea class="sheet-small sheet-vertical" name="attr_notes"></textarea>


                
        </div>
    </div>

        </div>
    </div>

    
    <div class="sheet-sidebar">
        

    <div class="sheet-bubble ">
        <div class="sheet-content">
            <label>Skills</label>

            
                    
    <div class="sheet-list">
        
            <div class="sheet-line">
                <div class="sheet-label">Melee</div>
                <input type="text" class="sheet-number" name="attr_melee_skill" value="0"/>
            </div>
        
            <div class="sheet-line">
                <div class="sheet-label">Ranged</div>
                <input type="text" class="sheet-number" name="attr_ranged_skill" value="0"/>
            </div>
        
    </div>

                
        </div>
    </div>

    </div>
</div> 


    


<div class="sheet-weapon-slots">
    

    <div class="sheet-slot-section sheet-slot-section-weapon">
        <div class="sheet-row-flex sheet-label-row">
            <label>Weapons</label>
            <div class="sheet-subtext">
                Slots:
                <input type="text" class="sheet-number sheet-shy" name="attr_weaponslots" value="1"/>
            </div>
        
        </div>

        
        <div class="sheet-wrap sheet-slot-toggle">
            
             
                <input type="checkbox" class="sheet-hidden sheet-slot-toggle-1" name="attr_weaponslots" value="1" checked/>
             
                <input type="checkbox" class="sheet-hidden sheet-slot-toggle-2" name="attr_weaponslots" value="2" />
             
                <input type="checkbox" class="sheet-hidden sheet-slot-toggle-3" name="attr_weaponslots" value="3" />
            

            
             
                <div class="sheet-slot sheet-toggle sheet-slot-1">
                    
                    <input type="checkbox" class="sheet-active" name="attr_weapon_1" class="sheet-hidden sheet-toggle sheet-control" />
                    <div class="sheet-empty-text">Unused Slot</div>
                    <div class="sheet-content">
                        

    <div class="sheet-card">
        
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-inventory" name="attr_weapon_type_1" value="inventory" />
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-weapon" name="attr_weapon_type_1" value="weapon" checked/>
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-equipment" name="attr_weapon_type_1" value="equipment" />
        

        
        <div class="sheet-card-type">
            <select class="sheet-shy" name="attr_weapon_type_1">
                
                    <option value="inventory" >Consumable </option>
                
                    <option value="weapon"  selected="selected" >Weapon</option>
                
                    <option value="equipment" >Equipment</option>
                
            </select>            
            <select class="sheet-shy sheet-weapon-only" name="attr_weapon_weapontype_1">
                
                    <option value="melee"  selected="selected" >Melee</option>
                
                    <option value="ranged" >Ranged</option>
                
            </select>
        </div>

        
        <div class="sheet-card-name">
            <input type="text" name="attr_weapon_name_1" placeholder="Item Name">
        </div>

        
        <div class="sheet-card-weapon-fields">        
            
            
                <input type="checkbox" class="sheet-hidden sheet-show-melee" name="attr_weapon_weapontype_1" value="melee" checked/>
            
                <input type="checkbox" class="sheet-hidden sheet-show-ranged" name="attr_weapon_weapontype_1" value="ranged" />
            
            
            
            <div class="sheet-card-damage  sheet-card-line">
                <div class="sheet-label">Damage:</div>
                <input class="sheet-shy" type="text" name="attr_weapon_damage_1" value="0" />
            </div>

            
            <div class="sheet-card-uses sheet-card-line">
                <div class="sheet-label sheet-ranged-only">Ammo:</div>
                <div class="sheet-label sheet-melee-only">Durability:</div>
                <div class="sheet-max">
                    <div>
                        <input type="text" class="sheet-number sheet-shy" name="attr_weapon_uses_1" value="0"/>
                    </div>
                    <div class="sheet-divider">/</div>
                    <div>
                        <input type="text" class="sheet-number sheet-shy" name="attr_weapon_uses_1_max" value="0"/>
                    </div>
                </div>
            </div>

            
            

        </div>

        <div class="sheet-card-textarea">
            <textarea class="sheet-shy" name="attr_weapon_description_1"></textarea>
            <input type="text" class="sheet-hidden" name="attr_weapon_flavor_1"/>
            <span readonly name="attr_weapon_flavor_1"></span>
        </div>
        <div class="sheet-card-actions">
            
            <button type="roll" class="sheet-attack-button sheet-attack-melee btn" 
            value="!!attack rolls='?{Number of Attacks | @{ap_rolls}}' defend='?{Number of Defense Rolls | @{ap_rolls}}' dice='@{weapon_damage_1}' weaponname='@{weapon_name_1}' type='@{weapon_weapontype_1}' resource='weapon_uses_1' characterid='@{character_id}'" name="roll_attackweapon >Attack/Defend</button">
            
            <button type="action" class="sheet-equip-button btn" name="act_weapon_equipitem_1">Equip</button>
            <button type="action" class="sheet-unequip-button btn" name="act_weapon_unequipitem_1">Unequip</button>
            <button type="roll" class="sheet-export-button" name="roll_exportitem" value="!!pickup  name=&#39;@{name}&#39;  type=&#39;@{type}&#39;  damage=&#39;@{damage}&#39;  weapontype=&#39;@{weapontype}&#39;  uses=&#39;@{uses}&#39;  description=&#39;@{description}&#39;  flavor=&#39;@{flavor}&#39;  characterid=@{target|Target 1|character_id}'" >Trade Item</button>
            <button type="action" class="sheet-delete-button btn-danger" name="act_weapon_deleteitem_1">Delete</button>
        </div>
    </div>

                    </div>
                </div>
             
                <div class="sheet-slot sheet-toggle sheet-slot-2">
                    
                    <input type="checkbox" class="sheet-active" name="attr_weapon_2" class="sheet-hidden sheet-toggle sheet-control" />
                    <div class="sheet-empty-text">Unused Slot</div>
                    <div class="sheet-content">
                        

    <div class="sheet-card">
        
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-inventory" name="attr_weapon_type_2" value="inventory" />
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-weapon" name="attr_weapon_type_2" value="weapon" checked/>
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-equipment" name="attr_weapon_type_2" value="equipment" />
        

        
        <div class="sheet-card-type">
            <select class="sheet-shy" name="attr_weapon_type_2">
                
                    <option value="inventory" >Consumable </option>
                
                    <option value="weapon"  selected="selected" >Weapon</option>
                
                    <option value="equipment" >Equipment</option>
                
            </select>            
            <select class="sheet-shy sheet-weapon-only" name="attr_weapon_weapontype_2">
                
                    <option value="melee"  selected="selected" >Melee</option>
                
                    <option value="ranged" >Ranged</option>
                
            </select>
        </div>

        
        <div class="sheet-card-name">
            <input type="text" name="attr_weapon_name_2" placeholder="Item Name">
        </div>

        
        <div class="sheet-card-weapon-fields">        
            
            
                <input type="checkbox" class="sheet-hidden sheet-show-melee" name="attr_weapon_weapontype_2" value="melee" checked/>
            
                <input type="checkbox" class="sheet-hidden sheet-show-ranged" name="attr_weapon_weapontype_2" value="ranged" />
            
            
            
            <div class="sheet-card-damage  sheet-card-line">
                <div class="sheet-label">Damage:</div>
                <input class="sheet-shy" type="text" name="attr_weapon_damage_2" value="0" />
            </div>

            
            <div class="sheet-card-uses sheet-card-line">
                <div class="sheet-label sheet-ranged-only">Ammo:</div>
                <div class="sheet-label sheet-melee-only">Durability:</div>
                <div class="sheet-max">
                    <div>
                        <input type="text" class="sheet-number sheet-shy" name="attr_weapon_uses_2" value="0"/>
                    </div>
                    <div class="sheet-divider">/</div>
                    <div>
                        <input type="text" class="sheet-number sheet-shy" name="attr_weapon_uses_2_max" value="0"/>
                    </div>
                </div>
            </div>

            
            

        </div>

        <div class="sheet-card-textarea">
            <textarea class="sheet-shy" name="attr_weapon_description_2"></textarea>
            <input type="text" class="sheet-hidden" name="attr_weapon_flavor_2"/>
            <span readonly name="attr_weapon_flavor_2"></span>
        </div>
        <div class="sheet-card-actions">
            
            <button type="roll" class="sheet-attack-button sheet-attack-melee btn" 
            value="!!attack rolls='?{Number of Attacks | @{ap_rolls}}' defend='?{Number of Defense Rolls | @{ap_rolls}}' dice='@{weapon_damage_2}' weaponname='@{weapon_name_2}' type='@{weapon_weapontype_2}' resource='weapon_uses_2' characterid='@{character_id}'" name="roll_attackweapon >Attack/Defend</button">
            
            <button type="action" class="sheet-equip-button btn" name="act_weapon_equipitem_2">Equip</button>
            <button type="action" class="sheet-unequip-button btn" name="act_weapon_unequipitem_2">Unequip</button>
            <button type="roll" class="sheet-export-button" name="roll_exportitem" value="!!pickup  name=&#39;@{name}&#39;  type=&#39;@{type}&#39;  damage=&#39;@{damage}&#39;  weapontype=&#39;@{weapontype}&#39;  uses=&#39;@{uses}&#39;  description=&#39;@{description}&#39;  flavor=&#39;@{flavor}&#39;  characterid=@{target|Target 1|character_id}'" >Trade Item</button>
            <button type="action" class="sheet-delete-button btn-danger" name="act_weapon_deleteitem_2">Delete</button>
        </div>
    </div>

                    </div>
                </div>
             
                <div class="sheet-slot sheet-toggle sheet-slot-3">
                    
                    <input type="checkbox" class="sheet-active" name="attr_weapon_3" class="sheet-hidden sheet-toggle sheet-control" />
                    <div class="sheet-empty-text">Unused Slot</div>
                    <div class="sheet-content">
                        

    <div class="sheet-card">
        
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-inventory" name="attr_weapon_type_3" value="inventory" />
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-weapon" name="attr_weapon_type_3" value="weapon" checked/>
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-equipment" name="attr_weapon_type_3" value="equipment" />
        

        
        <div class="sheet-card-type">
            <select class="sheet-shy" name="attr_weapon_type_3">
                
                    <option value="inventory" >Consumable </option>
                
                    <option value="weapon"  selected="selected" >Weapon</option>
                
                    <option value="equipment" >Equipment</option>
                
            </select>            
            <select class="sheet-shy sheet-weapon-only" name="attr_weapon_weapontype_3">
                
                    <option value="melee"  selected="selected" >Melee</option>
                
                    <option value="ranged" >Ranged</option>
                
            </select>
        </div>

        
        <div class="sheet-card-name">
            <input type="text" name="attr_weapon_name_3" placeholder="Item Name">
        </div>

        
        <div class="sheet-card-weapon-fields">        
            
            
                <input type="checkbox" class="sheet-hidden sheet-show-melee" name="attr_weapon_weapontype_3" value="melee" checked/>
            
                <input type="checkbox" class="sheet-hidden sheet-show-ranged" name="attr_weapon_weapontype_3" value="ranged" />
            
            
            
            <div class="sheet-card-damage  sheet-card-line">
                <div class="sheet-label">Damage:</div>
                <input class="sheet-shy" type="text" name="attr_weapon_damage_3" value="0" />
            </div>

            
            <div class="sheet-card-uses sheet-card-line">
                <div class="sheet-label sheet-ranged-only">Ammo:</div>
                <div class="sheet-label sheet-melee-only">Durability:</div>
                <div class="sheet-max">
                    <div>
                        <input type="text" class="sheet-number sheet-shy" name="attr_weapon_uses_3" value="0"/>
                    </div>
                    <div class="sheet-divider">/</div>
                    <div>
                        <input type="text" class="sheet-number sheet-shy" name="attr_weapon_uses_3_max" value="0"/>
                    </div>
                </div>
            </div>

            
            

        </div>

        <div class="sheet-card-textarea">
            <textarea class="sheet-shy" name="attr_weapon_description_3"></textarea>
            <input type="text" class="sheet-hidden" name="attr_weapon_flavor_3"/>
            <span readonly name="attr_weapon_flavor_3"></span>
        </div>
        <div class="sheet-card-actions">
            
            <button type="roll" class="sheet-attack-button sheet-attack-melee btn" 
            value="!!attack rolls='?{Number of Attacks | @{ap_rolls}}' defend='?{Number of Defense Rolls | @{ap_rolls}}' dice='@{weapon_damage_3}' weaponname='@{weapon_name_3}' type='@{weapon_weapontype_3}' resource='weapon_uses_3' characterid='@{character_id}'" name="roll_attackweapon >Attack/Defend</button">
            
            <button type="action" class="sheet-equip-button btn" name="act_weapon_equipitem_3">Equip</button>
            <button type="action" class="sheet-unequip-button btn" name="act_weapon_unequipitem_3">Unequip</button>
            <button type="roll" class="sheet-export-button" name="roll_exportitem" value="!!pickup  name=&#39;@{name}&#39;  type=&#39;@{type}&#39;  damage=&#39;@{damage}&#39;  weapontype=&#39;@{weapontype}&#39;  uses=&#39;@{uses}&#39;  description=&#39;@{description}&#39;  flavor=&#39;@{flavor}&#39;  characterid=@{target|Target 1|character_id}'" >Trade Item</button>
            <button type="action" class="sheet-delete-button btn-danger" name="act_weapon_deleteitem_3">Delete</button>
        </div>
    </div>

                    </div>
                </div>
            
        </div>
    </div>


</div>

<div class="sheet-equipment-slots">
    

    <div class="sheet-slot-section sheet-slot-section-equipment">
        <div class="sheet-row-flex sheet-label-row">
            <label>Equipment</label>
            <div class="sheet-subtext">
                Slots:
                <input type="text" class="sheet-number sheet-shy" name="attr_equipmentslots" value="3"/>
            </div>
        
        </div>

        
        <div class="sheet-wrap sheet-slot-toggle">
            
             
                <input type="checkbox" class="sheet-hidden sheet-slot-toggle-1" name="attr_equipmentslots" value="1" checked/>
             
                <input type="checkbox" class="sheet-hidden sheet-slot-toggle-2" name="attr_equipmentslots" value="2" checked/>
             
                <input type="checkbox" class="sheet-hidden sheet-slot-toggle-3" name="attr_equipmentslots" value="3" checked/>
             
                <input type="checkbox" class="sheet-hidden sheet-slot-toggle-4" name="attr_equipmentslots" value="4" />
             
                <input type="checkbox" class="sheet-hidden sheet-slot-toggle-5" name="attr_equipmentslots" value="5" />
            

            
             
                <div class="sheet-slot sheet-toggle sheet-slot-1">
                    
                    <input type="checkbox" class="sheet-active" name="attr_equipment_1" class="sheet-hidden sheet-toggle sheet-control" />
                    <div class="sheet-empty-text">Unused Slot</div>
                    <div class="sheet-content">
                        

    <div class="sheet-card">
        
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-inventory" name="attr_equipment_type_1" value="inventory" />
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-weapon" name="attr_equipment_type_1" value="weapon" />
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-equipment" name="attr_equipment_type_1" value="equipment" checked/>
        

        
        <div class="sheet-card-type">
            <select class="sheet-shy" name="attr_equipment_type_1">
                
                    <option value="inventory" >Consumable </option>
                
                    <option value="weapon" >Weapon</option>
                
                    <option value="equipment"  selected="selected" >Equipment</option>
                
            </select>            
            <select class="sheet-shy sheet-weapon-only" name="attr_equipment_weapontype_1">
                
                    <option value="melee"  selected="selected" >Melee</option>
                
                    <option value="ranged" >Ranged</option>
                
            </select>
        </div>

        
        <div class="sheet-card-name">
            <input type="text" name="attr_equipment_name_1" placeholder="Item Name">
        </div>

        
        <div class="sheet-card-weapon-fields">        
            
            
                <input type="checkbox" class="sheet-hidden sheet-show-melee" name="attr_equipment_weapontype_1" value="melee" checked/>
            
                <input type="checkbox" class="sheet-hidden sheet-show-ranged" name="attr_equipment_weapontype_1" value="ranged" />
            
            
            
            <div class="sheet-card-damage  sheet-card-line">
                <div class="sheet-label">Damage:</div>
                <input class="sheet-shy" type="text" name="attr_equipment_damage_1" value="0" />
            </div>

            
            <div class="sheet-card-uses sheet-card-line">
                <div class="sheet-label sheet-ranged-only">Ammo:</div>
                <div class="sheet-label sheet-melee-only">Durability:</div>
                <div class="sheet-max">
                    <div>
                        <input type="text" class="sheet-number sheet-shy" name="attr_equipment_uses_1" value="0"/>
                    </div>
                    <div class="sheet-divider">/</div>
                    <div>
                        <input type="text" class="sheet-number sheet-shy" name="attr_equipment_uses_1_max" value="0"/>
                    </div>
                </div>
            </div>

            
            

        </div>

        <div class="sheet-card-textarea">
            <textarea class="sheet-shy" name="attr_equipment_description_1"></textarea>
            <input type="text" class="sheet-hidden" name="attr_equipment_flavor_1"/>
            <span readonly name="attr_equipment_flavor_1"></span>
        </div>
        <div class="sheet-card-actions">
            
            <button type="roll" class="sheet-attack-button sheet-attack-melee btn" 
            value="!!attack rolls='?{Number of Attacks | @{ap_rolls}}' defend='?{Number of Defense Rolls | @{ap_rolls}}' dice='@{equipment_damage_1}' weaponname='@{equipment_name_1}' type='@{equipment_weapontype_1}' resource='equipment_uses_1' characterid='@{character_id}'" name="roll_attackweapon >Attack/Defend</button">
            
            <button type="action" class="sheet-equip-button btn" name="act_equipment_equipitem_1">Equip</button>
            <button type="action" class="sheet-unequip-button btn" name="act_equipment_unequipitem_1">Unequip</button>
            <button type="roll" class="sheet-export-button" name="roll_exportitem" value="!!pickup  name=&#39;@{name}&#39;  type=&#39;@{type}&#39;  damage=&#39;@{damage}&#39;  weapontype=&#39;@{weapontype}&#39;  uses=&#39;@{uses}&#39;  description=&#39;@{description}&#39;  flavor=&#39;@{flavor}&#39;  characterid=@{target|Target 1|character_id}'" >Trade Item</button>
            <button type="action" class="sheet-delete-button btn-danger" name="act_equipment_deleteitem_1">Delete</button>
        </div>
    </div>

                    </div>
                </div>
             
                <div class="sheet-slot sheet-toggle sheet-slot-2">
                    
                    <input type="checkbox" class="sheet-active" name="attr_equipment_2" class="sheet-hidden sheet-toggle sheet-control" />
                    <div class="sheet-empty-text">Unused Slot</div>
                    <div class="sheet-content">
                        

    <div class="sheet-card">
        
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-inventory" name="attr_equipment_type_2" value="inventory" />
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-weapon" name="attr_equipment_type_2" value="weapon" />
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-equipment" name="attr_equipment_type_2" value="equipment" checked/>
        

        
        <div class="sheet-card-type">
            <select class="sheet-shy" name="attr_equipment_type_2">
                
                    <option value="inventory" >Consumable </option>
                
                    <option value="weapon" >Weapon</option>
                
                    <option value="equipment"  selected="selected" >Equipment</option>
                
            </select>            
            <select class="sheet-shy sheet-weapon-only" name="attr_equipment_weapontype_2">
                
                    <option value="melee"  selected="selected" >Melee</option>
                
                    <option value="ranged" >Ranged</option>
                
            </select>
        </div>

        
        <div class="sheet-card-name">
            <input type="text" name="attr_equipment_name_2" placeholder="Item Name">
        </div>

        
        <div class="sheet-card-weapon-fields">        
            
            
                <input type="checkbox" class="sheet-hidden sheet-show-melee" name="attr_equipment_weapontype_2" value="melee" checked/>
            
                <input type="checkbox" class="sheet-hidden sheet-show-ranged" name="attr_equipment_weapontype_2" value="ranged" />
            
            
            
            <div class="sheet-card-damage  sheet-card-line">
                <div class="sheet-label">Damage:</div>
                <input class="sheet-shy" type="text" name="attr_equipment_damage_2" value="0" />
            </div>

            
            <div class="sheet-card-uses sheet-card-line">
                <div class="sheet-label sheet-ranged-only">Ammo:</div>
                <div class="sheet-label sheet-melee-only">Durability:</div>
                <div class="sheet-max">
                    <div>
                        <input type="text" class="sheet-number sheet-shy" name="attr_equipment_uses_2" value="0"/>
                    </div>
                    <div class="sheet-divider">/</div>
                    <div>
                        <input type="text" class="sheet-number sheet-shy" name="attr_equipment_uses_2_max" value="0"/>
                    </div>
                </div>
            </div>

            
            

        </div>

        <div class="sheet-card-textarea">
            <textarea class="sheet-shy" name="attr_equipment_description_2"></textarea>
            <input type="text" class="sheet-hidden" name="attr_equipment_flavor_2"/>
            <span readonly name="attr_equipment_flavor_2"></span>
        </div>
        <div class="sheet-card-actions">
            
            <button type="roll" class="sheet-attack-button sheet-attack-melee btn" 
            value="!!attack rolls='?{Number of Attacks | @{ap_rolls}}' defend='?{Number of Defense Rolls | @{ap_rolls}}' dice='@{equipment_damage_2}' weaponname='@{equipment_name_2}' type='@{equipment_weapontype_2}' resource='equipment_uses_2' characterid='@{character_id}'" name="roll_attackweapon >Attack/Defend</button">
            
            <button type="action" class="sheet-equip-button btn" name="act_equipment_equipitem_2">Equip</button>
            <button type="action" class="sheet-unequip-button btn" name="act_equipment_unequipitem_2">Unequip</button>
            <button type="roll" class="sheet-export-button" name="roll_exportitem" value="!!pickup  name=&#39;@{name}&#39;  type=&#39;@{type}&#39;  damage=&#39;@{damage}&#39;  weapontype=&#39;@{weapontype}&#39;  uses=&#39;@{uses}&#39;  description=&#39;@{description}&#39;  flavor=&#39;@{flavor}&#39;  characterid=@{target|Target 1|character_id}'" >Trade Item</button>
            <button type="action" class="sheet-delete-button btn-danger" name="act_equipment_deleteitem_2">Delete</button>
        </div>
    </div>

                    </div>
                </div>
             
                <div class="sheet-slot sheet-toggle sheet-slot-3">
                    
                    <input type="checkbox" class="sheet-active" name="attr_equipment_3" class="sheet-hidden sheet-toggle sheet-control" />
                    <div class="sheet-empty-text">Unused Slot</div>
                    <div class="sheet-content">
                        

    <div class="sheet-card">
        
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-inventory" name="attr_equipment_type_3" value="inventory" />
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-weapon" name="attr_equipment_type_3" value="weapon" />
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-equipment" name="attr_equipment_type_3" value="equipment" checked/>
        

        
        <div class="sheet-card-type">
            <select class="sheet-shy" name="attr_equipment_type_3">
                
                    <option value="inventory" >Consumable </option>
                
                    <option value="weapon" >Weapon</option>
                
                    <option value="equipment"  selected="selected" >Equipment</option>
                
            </select>            
            <select class="sheet-shy sheet-weapon-only" name="attr_equipment_weapontype_3">
                
                    <option value="melee"  selected="selected" >Melee</option>
                
                    <option value="ranged" >Ranged</option>
                
            </select>
        </div>

        
        <div class="sheet-card-name">
            <input type="text" name="attr_equipment_name_3" placeholder="Item Name">
        </div>

        
        <div class="sheet-card-weapon-fields">        
            
            
                <input type="checkbox" class="sheet-hidden sheet-show-melee" name="attr_equipment_weapontype_3" value="melee" checked/>
            
                <input type="checkbox" class="sheet-hidden sheet-show-ranged" name="attr_equipment_weapontype_3" value="ranged" />
            
            
            
            <div class="sheet-card-damage  sheet-card-line">
                <div class="sheet-label">Damage:</div>
                <input class="sheet-shy" type="text" name="attr_equipment_damage_3" value="0" />
            </div>

            
            <div class="sheet-card-uses sheet-card-line">
                <div class="sheet-label sheet-ranged-only">Ammo:</div>
                <div class="sheet-label sheet-melee-only">Durability:</div>
                <div class="sheet-max">
                    <div>
                        <input type="text" class="sheet-number sheet-shy" name="attr_equipment_uses_3" value="0"/>
                    </div>
                    <div class="sheet-divider">/</div>
                    <div>
                        <input type="text" class="sheet-number sheet-shy" name="attr_equipment_uses_3_max" value="0"/>
                    </div>
                </div>
            </div>

            
            

        </div>

        <div class="sheet-card-textarea">
            <textarea class="sheet-shy" name="attr_equipment_description_3"></textarea>
            <input type="text" class="sheet-hidden" name="attr_equipment_flavor_3"/>
            <span readonly name="attr_equipment_flavor_3"></span>
        </div>
        <div class="sheet-card-actions">
            
            <button type="roll" class="sheet-attack-button sheet-attack-melee btn" 
            value="!!attack rolls='?{Number of Attacks | @{ap_rolls}}' defend='?{Number of Defense Rolls | @{ap_rolls}}' dice='@{equipment_damage_3}' weaponname='@{equipment_name_3}' type='@{equipment_weapontype_3}' resource='equipment_uses_3' characterid='@{character_id}'" name="roll_attackweapon >Attack/Defend</button">
            
            <button type="action" class="sheet-equip-button btn" name="act_equipment_equipitem_3">Equip</button>
            <button type="action" class="sheet-unequip-button btn" name="act_equipment_unequipitem_3">Unequip</button>
            <button type="roll" class="sheet-export-button" name="roll_exportitem" value="!!pickup  name=&#39;@{name}&#39;  type=&#39;@{type}&#39;  damage=&#39;@{damage}&#39;  weapontype=&#39;@{weapontype}&#39;  uses=&#39;@{uses}&#39;  description=&#39;@{description}&#39;  flavor=&#39;@{flavor}&#39;  characterid=@{target|Target 1|character_id}'" >Trade Item</button>
            <button type="action" class="sheet-delete-button btn-danger" name="act_equipment_deleteitem_3">Delete</button>
        </div>
    </div>

                    </div>
                </div>
             
                <div class="sheet-slot sheet-toggle sheet-slot-4">
                    
                    <input type="checkbox" class="sheet-active" name="attr_equipment_4" class="sheet-hidden sheet-toggle sheet-control" />
                    <div class="sheet-empty-text">Unused Slot</div>
                    <div class="sheet-content">
                        

    <div class="sheet-card">
        
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-inventory" name="attr_equipment_type_4" value="inventory" />
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-weapon" name="attr_equipment_type_4" value="weapon" />
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-equipment" name="attr_equipment_type_4" value="equipment" checked/>
        

        
        <div class="sheet-card-type">
            <select class="sheet-shy" name="attr_equipment_type_4">
                
                    <option value="inventory" >Consumable </option>
                
                    <option value="weapon" >Weapon</option>
                
                    <option value="equipment"  selected="selected" >Equipment</option>
                
            </select>            
            <select class="sheet-shy sheet-weapon-only" name="attr_equipment_weapontype_4">
                
                    <option value="melee"  selected="selected" >Melee</option>
                
                    <option value="ranged" >Ranged</option>
                
            </select>
        </div>

        
        <div class="sheet-card-name">
            <input type="text" name="attr_equipment_name_4" placeholder="Item Name">
        </div>

        
        <div class="sheet-card-weapon-fields">        
            
            
                <input type="checkbox" class="sheet-hidden sheet-show-melee" name="attr_equipment_weapontype_4" value="melee" checked/>
            
                <input type="checkbox" class="sheet-hidden sheet-show-ranged" name="attr_equipment_weapontype_4" value="ranged" />
            
            
            
            <div class="sheet-card-damage  sheet-card-line">
                <div class="sheet-label">Damage:</div>
                <input class="sheet-shy" type="text" name="attr_equipment_damage_4" value="0" />
            </div>

            
            <div class="sheet-card-uses sheet-card-line">
                <div class="sheet-label sheet-ranged-only">Ammo:</div>
                <div class="sheet-label sheet-melee-only">Durability:</div>
                <div class="sheet-max">
                    <div>
                        <input type="text" class="sheet-number sheet-shy" name="attr_equipment_uses_4" value="0"/>
                    </div>
                    <div class="sheet-divider">/</div>
                    <div>
                        <input type="text" class="sheet-number sheet-shy" name="attr_equipment_uses_4_max" value="0"/>
                    </div>
                </div>
            </div>

            
            

        </div>

        <div class="sheet-card-textarea">
            <textarea class="sheet-shy" name="attr_equipment_description_4"></textarea>
            <input type="text" class="sheet-hidden" name="attr_equipment_flavor_4"/>
            <span readonly name="attr_equipment_flavor_4"></span>
        </div>
        <div class="sheet-card-actions">
            
            <button type="roll" class="sheet-attack-button sheet-attack-melee btn" 
            value="!!attack rolls='?{Number of Attacks | @{ap_rolls}}' defend='?{Number of Defense Rolls | @{ap_rolls}}' dice='@{equipment_damage_4}' weaponname='@{equipment_name_4}' type='@{equipment_weapontype_4}' resource='equipment_uses_4' characterid='@{character_id}'" name="roll_attackweapon >Attack/Defend</button">
            
            <button type="action" class="sheet-equip-button btn" name="act_equipment_equipitem_4">Equip</button>
            <button type="action" class="sheet-unequip-button btn" name="act_equipment_unequipitem_4">Unequip</button>
            <button type="roll" class="sheet-export-button" name="roll_exportitem" value="!!pickup  name=&#39;@{name}&#39;  type=&#39;@{type}&#39;  damage=&#39;@{damage}&#39;  weapontype=&#39;@{weapontype}&#39;  uses=&#39;@{uses}&#39;  description=&#39;@{description}&#39;  flavor=&#39;@{flavor}&#39;  characterid=@{target|Target 1|character_id}'" >Trade Item</button>
            <button type="action" class="sheet-delete-button btn-danger" name="act_equipment_deleteitem_4">Delete</button>
        </div>
    </div>

                    </div>
                </div>
             
                <div class="sheet-slot sheet-toggle sheet-slot-5">
                    
                    <input type="checkbox" class="sheet-active" name="attr_equipment_5" class="sheet-hidden sheet-toggle sheet-control" />
                    <div class="sheet-empty-text">Unused Slot</div>
                    <div class="sheet-content">
                        

    <div class="sheet-card">
        
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-inventory" name="attr_equipment_type_5" value="inventory" />
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-weapon" name="attr_equipment_type_5" value="weapon" />
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-equipment" name="attr_equipment_type_5" value="equipment" checked/>
        

        
        <div class="sheet-card-type">
            <select class="sheet-shy" name="attr_equipment_type_5">
                
                    <option value="inventory" >Consumable </option>
                
                    <option value="weapon" >Weapon</option>
                
                    <option value="equipment"  selected="selected" >Equipment</option>
                
            </select>            
            <select class="sheet-shy sheet-weapon-only" name="attr_equipment_weapontype_5">
                
                    <option value="melee"  selected="selected" >Melee</option>
                
                    <option value="ranged" >Ranged</option>
                
            </select>
        </div>

        
        <div class="sheet-card-name">
            <input type="text" name="attr_equipment_name_5" placeholder="Item Name">
        </div>

        
        <div class="sheet-card-weapon-fields">        
            
            
                <input type="checkbox" class="sheet-hidden sheet-show-melee" name="attr_equipment_weapontype_5" value="melee" checked/>
            
                <input type="checkbox" class="sheet-hidden sheet-show-ranged" name="attr_equipment_weapontype_5" value="ranged" />
            
            
            
            <div class="sheet-card-damage  sheet-card-line">
                <div class="sheet-label">Damage:</div>
                <input class="sheet-shy" type="text" name="attr_equipment_damage_5" value="0" />
            </div>

            
            <div class="sheet-card-uses sheet-card-line">
                <div class="sheet-label sheet-ranged-only">Ammo:</div>
                <div class="sheet-label sheet-melee-only">Durability:</div>
                <div class="sheet-max">
                    <div>
                        <input type="text" class="sheet-number sheet-shy" name="attr_equipment_uses_5" value="0"/>
                    </div>
                    <div class="sheet-divider">/</div>
                    <div>
                        <input type="text" class="sheet-number sheet-shy" name="attr_equipment_uses_5_max" value="0"/>
                    </div>
                </div>
            </div>

            
            

        </div>

        <div class="sheet-card-textarea">
            <textarea class="sheet-shy" name="attr_equipment_description_5"></textarea>
            <input type="text" class="sheet-hidden" name="attr_equipment_flavor_5"/>
            <span readonly name="attr_equipment_flavor_5"></span>
        </div>
        <div class="sheet-card-actions">
            
            <button type="roll" class="sheet-attack-button sheet-attack-melee btn" 
            value="!!attack rolls='?{Number of Attacks | @{ap_rolls}}' defend='?{Number of Defense Rolls | @{ap_rolls}}' dice='@{equipment_damage_5}' weaponname='@{equipment_name_5}' type='@{equipment_weapontype_5}' resource='equipment_uses_5' characterid='@{character_id}'" name="roll_attackweapon >Attack/Defend</button">
            
            <button type="action" class="sheet-equip-button btn" name="act_equipment_equipitem_5">Equip</button>
            <button type="action" class="sheet-unequip-button btn" name="act_equipment_unequipitem_5">Unequip</button>
            <button type="roll" class="sheet-export-button" name="roll_exportitem" value="!!pickup  name=&#39;@{name}&#39;  type=&#39;@{type}&#39;  damage=&#39;@{damage}&#39;  weapontype=&#39;@{weapontype}&#39;  uses=&#39;@{uses}&#39;  description=&#39;@{description}&#39;  flavor=&#39;@{flavor}&#39;  characterid=@{target|Target 1|character_id}'" >Trade Item</button>
            <button type="action" class="sheet-delete-button btn-danger" name="act_equipment_deleteitem_5">Delete</button>
        </div>
    </div>

                    </div>
                </div>
            
        </div>
    </div>


</div>
    

        <div class="sheet-inventory">
        <div class="sheet-slot-section">
            <div class="sheet-row-flex sheet-label-row">
                <label>Inventory</label>
                <div class="sheet-subtext">
                    Slots:
                    <input type="text" class="sheet-number sheet-shy" name="attr_inventory" value="5"/>
                </div>
            </div>
            <fieldset class="repeating_inventory">
                <div class="sheet-slot">
                    

    <div class="sheet-card">
        
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-inventory" name="attr_type" value="inventory" />
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-weapon" name="attr_type" value="weapon" />
        
            <input type="checkbox" class="sheet-hidden sheet-toggle-equipment" name="attr_type" value="equipment" />
        

        
        <div class="sheet-card-type">
            <select class="sheet-shy" name="attr_type">
                
                    <option value="inventory" >Consumable </option>
                
                    <option value="weapon" >Weapon</option>
                
                    <option value="equipment" >Equipment</option>
                
            </select>            
            <select class="sheet-shy sheet-weapon-only" name="attr_weapontype">
                
                    <option value="melee"  selected="selected" >Melee</option>
                
                    <option value="ranged" >Ranged</option>
                
            </select>
        </div>

        
        <div class="sheet-card-name">
            <input type="text" name="attr_name" placeholder="Item Name">
        </div>

        
        <div class="sheet-card-weapon-fields">        
            
            
                <input type="checkbox" class="sheet-hidden sheet-show-melee" name="attr_weapontype" value="melee" checked/>
            
                <input type="checkbox" class="sheet-hidden sheet-show-ranged" name="attr_weapontype" value="ranged" />
            
            
            
            <div class="sheet-card-damage  sheet-card-line">
                <div class="sheet-label">Damage:</div>
                <input class="sheet-shy" type="text" name="attr_damage" value="0" />
            </div>

            
            <div class="sheet-card-uses sheet-card-line">
                <div class="sheet-label sheet-ranged-only">Ammo:</div>
                <div class="sheet-label sheet-melee-only">Durability:</div>
                <div class="sheet-max">
                    <div>
                        <input type="text" class="sheet-number sheet-shy" name="attr_uses" value="0"/>
                    </div>
                    <div class="sheet-divider">/</div>
                    <div>
                        <input type="text" class="sheet-number sheet-shy" name="attr_uses_max" value="0"/>
                    </div>
                </div>
            </div>

            
            

        </div>

        <div class="sheet-card-textarea">
            <textarea class="sheet-shy" name="attr_description"></textarea>
            <input type="text" class="sheet-hidden" name="attr_flavor"/>
            <span readonly name="attr_flavor"></span>
        </div>
        <div class="sheet-card-actions">
            
            <button type="roll" class="sheet-attack-button sheet-attack-melee btn" 
            value="!!attack rolls='?{Number of Attacks | @{ap_rolls}}' defend='?{Number of Defense Rolls | @{ap_rolls}}' dice='@{damage}' weaponname='@{name}' type='@{weapontype}' resource='uses' characterid='@{character_id}'" name="roll_attackweapon >Attack/Defend</button">
            
            <button type="action" class="sheet-equip-button btn" name="act_equipitem">Equip</button>
            <button type="action" class="sheet-unequip-button btn" name="act_unequipitem">Unequip</button>
            <button type="roll" class="sheet-export-button" name="roll_exportitem" value="!!pickup  name=&#39;@{name}&#39;  type=&#39;@{type}&#39;  damage=&#39;@{damage}&#39;  weapontype=&#39;@{weapontype}&#39;  uses=&#39;@{uses}&#39;  description=&#39;@{description}&#39;  flavor=&#39;@{flavor}&#39;  characterid=@{target|Target 1|character_id}'" >Trade Item</button>
            <button type="action" class="sheet-delete-button btn-danger" name="act_deleteitem">Delete</button>
        </div>
    </div>

                </div>
            </fieldset>
        </div>
    </div> 


</div>


<script type="text/worker">
    /** inject:workers **/
    (function () {
    'use strict';

    var abilities = [
    	{
    		id: "",
    		label: "",
    		description: ""
    	},
    	{
    		id: "actionstar",
    		label: "Action Star",
    		description: "Increase your max action points by 2"
    	},
    	{
    		id: "cheerleader",
    		label: "Cheerleader",
    		description: "<strong>Action:</strong> Give adjacent players a single bonus dice roll until your next turn."
    	},
    	{
    		id: "brawler",
    		label: "Brawler",
    		description: "Adds 2 bonus rolls to any melee attack."
    	},
    	{
    		id: "builder",
    		label: "Builder",
    		description: "Use a D10 when building barricades and add 1 bonus dice roll."
    	},
    	{
    		id: "doctor",
    		label: "Doctor",
    		description: "Use a D10 when restoring health and add 1 bonus dice roll."
    	},
    	{
    		id: "Reflexes",
    		label: "Reflexes",
    		description: "Use a D10 when doing defense rolls."
    	},
    	{
    		id: "scavenger",
    		label: "Scavenger",
    		description: "Whenever you scavenge, scavenge 1 additional item."
    	},
    	{
    		id: "scout",
    		label: "Scout",
    		description: "Gain better vision in the dark. Sense approaching enemies."
    	},
    	{
    		id: "sniper",
    		label: "Sniper",
    		description: "Add +2 on every attack roll you make."
    	},
    	{
    		id: "tanky",
    		label: "Tanky",
    		description: "Increase your starting health by 20."
    	}
    ];

    var abilities$1 = /*#__PURE__*/Object.freeze({
        __proto__: null,
        'default': abilities
    });

    const fields$1 = {
        notes: {
            id: "notes",
            type: "textarea"
        },
        ammo: {
            id: "ammo",
            type: "list",
            options: {
                d4: {
                    id: "ammo_d4",
                    default: 0,
                    label: "d4"
                },
                d6: {
                    id: "ammo_d6",
                    default: 0,
                    label: "d6"
                },
                d8: {
                    id: "ammo_d8",
                    default: 0,
                    label: "d8"
                },
                d10: {
                    id: "ammo_d10",
                    default: 0,
                    label: "d10"
                },
                d12: {
                    id: "ammo_d12",
                    default: 0,
                    label: "d12"
                },
                d20: {
                    id: "ammo_d20",
                    default: 0,
                    label: "d20"
                },
                bolt: {
                    id: "ammo_bolt",
                    default: 0,
                    label: "Bolts"
                },
                arrow: {
                    id: "ammo_arrow",
                    default: 0,
                    label: "Arrows"
                }
            }
        },
        stats: {
            hp: {
                id: "hp",
                default: 30,
                type: "max",
                label: "HP"
            },
            ap: {
                id: "ap",
                default: 5,
                type: "max",
                label: "AP",
                rollable: true
            },
        },
        skills: {
            id: "skills",
            type: "list",
            options: {
                melee: {
                    id: "melee_skill",
                    default: "0",
                    label: "Melee"
                },
                ranged: {
                    id: "ranged_skill",
                    default: "0",
                    label: "Ranged"
                }
            }
        },
        defense: {
            id: "defense",
            default: 4,
            type: "dice",
            bonus: {
                id: 'defense_bonus',
                default: 0
            }
        },
        ability: {
            id: "ability",
            type: "toggleselect",
            options: abilities$1
        },
        weaponslots: {
            id: "weaponslots",
            label: "Weapons",
            default: 1,
            max: 3,
            type: "weapon"
        },
        equipmentslots: {
            id: "equipmentslots",
            default: 3,
            max: 5,
            type: "equipment",
            label: "Equipment"
        },
        inventory: {
            id: "inventory",
            default: 5,
            max: 9,
            label: "Inventory"
        }
    };

    const fields = {
        name: {
            id: 'name'
        },
        type: {
            id: 'type',
            label: "Item Type",
            options: [
                'inventory',
                'weapon',
                'equipment'
            ]
        },
        damage: {
            id: 'damage'
        },
        weapontype: {
            id: 'weapontype',
            options: [
                'melee',
                'ranged'
            ],
            label: 'Weapon Type',
            default: 'melee'
        },
        uses: {
            id: 'uses',
            max: true,
            labels: {
                melee: 'Durability',
                ranged: 'Ammo'
            }
        },
        // ammotype: {
        //     id: 'ammotype',
        //     label: 'Ammo Type'
        // },
        description: {
            id: 'description'
        }, 
        flavor: {
            id: 'flavor'
        },
    };


    const options = {
        actions: {
            export:'exportitem', 
            delete:'deleteitem',
            attack:'attackweapon',
            reload: 'reloadweapon',
            equip: 'equipitem',
            unequip: 'unequipitem'
        }
    };

    const getButtonRowId = function(eventInfo){
        var underscoreIndex = eventInfo.sourceAttribute.lastIndexOf("_");
        return eventInfo.sourceAttribute.substr(0, underscoreIndex);
    };

    /**
     * Given a number, spread it out and list all numbers preceding it.
     */
     const sequenceNumber = (num, delim='', flip=false) => {
        var result = '';

        if (!Number.isInteger(num)){
            return '';
        }

        if (flip){
            for (let i = num; i >= 0; i--){
                result += i.toString();
        
                if (i > 0 && delim.length){
                    result += delim;
                }
            }
        } else {
            
            for (let i = 0; i <= num; i++){
                result += i.toString();
        
                if (i < num && delim.length){
                    result += delim;
                }
            }
        }

        return result;
    };

    function deleteItem(){
        on(`clicked:repeating_${fields$1.inventory.id}:${options.actions.delete}`, function(evInfo){
            const rowId = getButtonRowId(evInfo);
            removeRepeatingRow(rowId);
        });
    }

    function equip(){
        const itemFields = {...fields};

        //This gets all available equipment/weapon slots.
        const slotFields = (function(){
            let result = [
                fields$1.equipmentslots.id,
                fields$1.weaponslots.id
            ];

            for (let i = 1; i <= fields$1.equipmentslots.max; i++){
                result.push(fields$1.equipmentslots.type + '_' + i);
            }

            for (let i = 1; i <= fields$1.weaponslots.max; i++){
                result.push(fields$1.weaponslots.type + '_' + i);
            }

            return result;
        })();

        //Finds the next available slot for a given type. Pass it values so it can parse through the values - values should contain the retrieved values for all available slots.
        const findAvailableSlot = function(type, values){
            let max = (type == fields$1.weaponslots.type) ? values[fields$1.weaponslots.id] : values[fields$1.equipmentslots.id];

            for (let i = 1; i <= max; i++){
                if (values[type + '_' + i] == 0){
                    return i;
                }
            }

            return null;
        };

        //get appropriate ID for an attribute in a slot.
        const getSlotId = function(type, attrId, slot){
            return `${type}_${attrId}_${slot}`
        };

        // Create an array of appropriate field Ids.
        // Give it a prefix to just append a simple prefix to the Id as in the case of repeating inventory
        // Give it a type and slot to call getSlotId as in the case of slots.
        const createFieldIdArray = function(prefix, type, slot){
            let result = [];

            for (let key in itemFields){
                let fld = itemFields[key];
                let name;
                if (prefix.length){
                    name = prefix + '_' + fld.id;
                } else if (type && slot){
                    name = getSlotId(type, fld.id, slot);
                } else {
                    name = fld.id;
                }
                result.push(name);

                if ('max' in fld && fld.max == true){
                    result.push(name + '_max');
                }
            }
            return result;
        };


        const unequipItem = function(type, slot){
            let unequipFields = createFieldIdArray('', type, slot);
            
            getAttrs(unequipFields, function(values){
                const rowId = generateRowID();
                var attrSet = {};

                for (const key in itemFields){
                    const fld = itemFields[key]; //the original field
                    
                    //unequiping is basically swapping objects
                    const unequipkey = getSlotId(type, fld.id, slot);
                    const invkey = `repeating_${fields$1.inventory.id}_${rowId}_${fld.id}`;

                    attrSet[invkey] = values[unequipkey];

                    if ('max' in fld && fld.max == true){
                        attrSet[invkey + '_max'] = values[unequipkey + '_max'];
                    }


                    //clear out equipped fields
                    if ('default' in fld){
                        attrSet[unequipkey] = fld.default;
                    } else {
                        attrSet[unequipkey] = '';

                        if ('max' in fld && fld.max == true){
                            attrSet[unequipkey + '_max'] = '';
                        }
                    }
                }

                attrSet[type + '_' + slot] = 0; //make the slot available again.

                console.log(attrSet);
                setAttrs(attrSet);
            });
        };


        const equipItem = function(rowId){
            // Get both slots and inventory fields
            const invFields = createFieldIdArray('repeating_' + fields$1.inventory.id);

            const bothFields = invFields.concat(slotFields);

            getAttrs(bothFields, function(values){
                //retrieve given card type.
                let type = values[`repeating_inventory_${fields.type.id}`];
                if (type == fields$1.inventory.type){ return;} //only equip weapons and equipment
                
                let slot = findAvailableSlot(type, values); //now find an available slot for its type.

                //Slot is available!
                if (slot){
                    var attrSet = {};

                    //Loop to transpose repeating inventory field to the appropriate slot
                    //basically swapping objects
                    for (const key in itemFields) {
                        const fld = itemFields[key];
                        const invkey = `repeating_${fields$1.inventory.id}_${fld.id}`;
                        const equipkey = getSlotId(type, fld.id, slot);

                        if (invkey in values && typeof values[invkey] != 'undefined'){
                            attrSet[equipkey] = values[invkey];
                            
                            // don't forget max
                            if ('max' in fld && fld.max == true){
                                attrSet[equipkey + '_max'] = values[invkey + '_max'];
                            }
                        } else {
                            attrSet[equipkey] = ''; //default value
                        }
                    }

                    attrSet[type + '_' + slot] = 'on';
                    removeRepeatingRow(rowId); //remove current row
                    setAttrs(attrSet);
                }
            });
        };


        // Hooks for buttons
        on(`clicked:repeating_${fields$1.inventory.id}:${options.actions.equip}`, function(evInfo){
            const rowId = getButtonRowId(evInfo);
            equipItem(rowId);
        });


        for (let i = 1; i <= fields$1.weaponslots.max; i++){
            on(`clicked:${fields$1.weaponslots.type}_${options.actions.unequip}_${i}`, function(){
                unequipItem(fields$1.weaponslots.type, i);
            });
        }

        for (let i = 1; i <= fields$1.equipmentslots.max; i++){
            on(`clicked:${fields$1.equipmentslots.type}_${options.actions.unequip}_${i}`, function(){
                unequipItem(fields$1.equipmentslots.type, i);
            });
        }
    }

    function limit(){
        on(`change:repeating_${fields$1.inventory.id}`, function(evInfo){

            //So we don't interfere with unequip script
            if (evInfo.sourceType == 'sheetworker'){
                return;
            }


            getAttrs([fields$1.inventory.id], function(values){
                let slots = parseInt(values[fields$1.inventory.id], 10);

                if (isNaN(slots)){
                    console.error('Error when parsing slots');
                    return;
                }

                getSectionIDs(fields$1.inventory.id, function(arr){

                    if (arr.length > slots){
                        let lastRow = arr[arr.length - 1]; //only remove the latest one, so we don't interfere with unequip
                        removeRepeatingRow(`repeating_${fields$1.inventory.id}_` + lastRow);
                    }
                });
            });
        });
    }

    //If a Stat is rollable, set a _rolls field to be a sequence of numbers
    //ie if stat is 5, set _rolls field to be 1|2|3|4|5
    //That way, we can use dropdowns for roll buttons based on the stats value
    function rollOptions(){
        for (let stat in fields$1.stats){
            let curStat = fields$1.stats[stat];

            if (curStat.rollable){
                let attr = curStat.id;
        
                on( 'change:' + attr, function(){
                    getAttrs([attr], function(values){
                        let numOfDice = parseInt(values[attr], 10);

                        var attrSet = {
                            [attr + '_rolls'] : sequenceNumber(numOfDice, '|', true) //start at value
                        };

                        console.log(attrSet);
        
                        setAttrs(attrSet);

                    });
                });
            }
        }

    }

    equip();
    limit();
    rollOptions();
    deleteItem();

})();

    /** endinject **/
</script>